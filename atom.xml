<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>菜鸟Miao</title>
  <subtitle>start from a newb...</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.newbmiao.com/"/>
  <updated>2017-05-16T11:11:03.000Z</updated>
  <id>http://blog.newbmiao.com/</id>
  
  <author>
    <name>菜鸟Miao</name>
    <email>newbvirgil@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>跨域登录态共享</title>
    <link href="http://blog.newbmiao.com/2017/05/16/share-the-login-status-under-cors.html"/>
    <id>http://blog.newbmiao.com/2017/05/16/share-the-login-status-under-cors.html</id>
    <published>2017-05-16T10:53:38.000Z</published>
    <updated>2017-05-16T11:11:03.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;登录态共享&quot;&gt;&lt;a href=&quot;#登录态共享&quot; class=&quot;headerlink&quot; title=&quot;登录态共享&quot;&gt;&lt;/a&gt;登录态共享&lt;/h1&gt;&lt;p&gt;登录态共享？什么鬼，不知道的就可以不用看啦，需要时再说，说不定到时也用不到，笑脸~~&lt;/p&gt;
&lt;h2 id=&quot;场景&quot;&gt;&lt;a href=&quot;#场景&quot; class=&quot;headerlink&quot; title=&quot;场景&quot;&gt;&lt;/a&gt;场景&lt;/h2&gt;&lt;p&gt;解决多个子系统中共用模块（比方说工单系统）可以共享子系统的登录态&lt;br&gt;为简化问题，设定场景：&lt;br&gt;登录系统A，点工单操作跳转系统B，并且无需登录（至于系统登录何时失效暂不考虑）&lt;/p&gt;
&lt;p&gt;还有：别问我为什么不用单点登录(SSO)，那个，不想说，笑脸~~&lt;/p&gt;
&lt;p&gt;先别废话，直接代码上&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;系统A&quot;&gt;&lt;a href=&quot;#系统A&quot; class=&quot;headerlink&quot; title=&quot;系统A&quot;&gt;&lt;/a&gt;系统A&lt;/h2&gt;&lt;h3 id=&quot;跳转自动登录&quot;&gt;&lt;a href=&quot;#跳转自动登录&quot; class=&quot;headerlink&quot; title=&quot;跳转自动登录&quot;&gt;&lt;/a&gt;跳转自动登录&lt;/h3&gt;&lt;hr&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//假定在 http://shop.laradock.dev/ 点击工单button执行&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; taskApi=&lt;span class=&quot;string&quot;&gt;&#39;http://localhost:10100/&#39;&lt;/span&gt;;&lt;span class=&quot;comment&quot;&gt;//工单系统地址&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;$.ajax(&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    url: taskApi+&lt;span class=&quot;string&quot;&gt;&#39;login&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    type: &lt;span class=&quot;string&quot;&gt;&quot;post&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    dataType: &lt;span class=&quot;string&quot;&gt;&quot;json&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    data: &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        username:&lt;span class=&quot;string&quot;&gt;&#39;newbmiao&#39;&lt;/span&gt;,&lt;span class=&quot;comment&quot;&gt;//账户唯一标识&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        refer:location.href,&lt;span class=&quot;comment&quot;&gt;//可用于工单系统跳回A使用&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    xhrFields: &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        withCredentials: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;//大招在这里&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    success: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;res&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(res);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//自动登录成功后跳转（什么？已经登陆了？！）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//location.href=taskApi;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&quot;工单系统B&quot;&gt;&lt;a href=&quot;#工单系统B&quot; class=&quot;headerlink&quot; title=&quot;工单系统B&quot;&gt;&lt;/a&gt;工单系统B&lt;/h2&gt;&lt;h3 id=&quot;登录逻辑&quot;&gt;&lt;a href=&quot;#登录逻辑&quot; class=&quot;headerlink&quot; title=&quot;登录逻辑&quot;&gt;&lt;/a&gt;登录逻辑&lt;/h3&gt;&lt;p&gt;不用想的是,接到username，校验是管理员等等，ok的话设置到session返回给系统A&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;问题1：系统A怎么跨域请求&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;有人想到&lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt;了，就是这个&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;问题2：服务器B&lt;code&gt;session&lt;/code&gt;设置没问题，怎么系统A能拿到&lt;code&gt;session&lt;/code&gt;的&lt;code&gt;cookie&lt;/code&gt; ？拿到了再请求服务器B,&lt;code&gt;cookie&lt;/code&gt;能拿到么？&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;好问题，还是cors解决了，不过这个是双向的&lt;/p&gt;
&lt;p&gt;&lt;code&gt;就是客户端说：我请求会带你给我的cookie，服务器说：我也允许读取你传递的cookie&lt;/code&gt;&lt;br&gt;当然不是什么cookie都能回传，只能是系统B设置的cookie（而且系统B其实能设置成功的话，也必须将&lt;code&gt;Access-Control-Allow-Origin&lt;/code&gt;明确指定为系统A）&lt;/p&gt;
&lt;p&gt;有没有晕，多读几遍就好了&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;附文一篇巩固下：&lt;a href=&quot;http://www.ruanyifeng.com/blog/2016/04/cors.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;跨域资源共享CORS详解&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;思路对了，最后就是就是怎么按cors设置了&lt;/p&gt;
&lt;hr&gt;
&lt;figure class=&quot;highlight go&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//按go (beego) 代码写的，但很简单，相信能看懂&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//看不懂，好吧，请喷吧，笑脸~~&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//in_array&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;InArray&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(val &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;, array []&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;)&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;(exists &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt;, index &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    exists = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    index = &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i, v := &lt;span class=&quot;keyword&quot;&gt;range&lt;/span&gt; array &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; val == v &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            index = i&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            exists = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//这里是重点&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;(c *BaseController)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addAccessControlHeader&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    r := c.Ctx.Request&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    w := c.Ctx.ResponseWriter&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//假定配置好的两个系统域名&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    originUrls:= &lt;span class=&quot;string&quot;&gt;&quot;http://shop.laradock.dev/,http://another-shop.laradock.dev/&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    originArr := strings.Split(originUrls, &lt;span class=&quot;string&quot;&gt;&quot;,&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    Origin := r.Header.Get(&lt;span class=&quot;string&quot;&gt;&quot;Origin&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; != &lt;span class=&quot;built_in&quot;&gt;len&lt;/span&gt;(Origin) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        isExist, index := help.InArray(Origin, originArr)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; !isExist &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            c.echoJson(&lt;span class=&quot;string&quot;&gt;&quot;请求未授权&quot;&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        w.Header().Add(&lt;span class=&quot;string&quot;&gt;&quot;Access-Control-Allow-Origin&quot;&lt;/span&gt;, originArr[index])&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        w.Header().Add(&lt;span class=&quot;string&quot;&gt;&quot;Access-Control-Allow-Methods&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;POST,GET,OPTIONS&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        w.Header().Add(&lt;span class=&quot;string&quot;&gt;&quot;Access-Control-Allow-Headers&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;x-requested-with,content-type&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        w.Header().Add(&lt;span class=&quot;string&quot;&gt;&quot;Access-Control-Allow-Credentials&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;true&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//json输出&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;(c *BaseController)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;echoJson&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(data &lt;span class=&quot;keyword&quot;&gt;interface&lt;/span&gt;&amp;#123;&amp;#125;, msg &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;, code &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;map&lt;/span&gt;[&lt;span class=&quot;title&quot;&gt;string&lt;/span&gt;]&lt;span class=&quot;title&quot;&gt;interface&lt;/span&gt;&lt;/span&gt;&amp;#123;&amp;#125; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    c.addAccessControlHeader()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    ret := &lt;span class=&quot;built_in&quot;&gt;make&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;map&lt;/span&gt;[&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;]&lt;span class=&quot;keyword&quot;&gt;interface&lt;/span&gt;&amp;#123;&amp;#125;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    ret[&lt;span class=&quot;string&quot;&gt;&quot;data&quot;&lt;/span&gt;] = data&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    ret[&lt;span class=&quot;string&quot;&gt;&quot;msg&quot;&lt;/span&gt;] = msg&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    ret[&lt;span class=&quot;string&quot;&gt;&quot;code&quot;&lt;/span&gt;] = code&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    c.Data[&lt;span class=&quot;string&quot;&gt;&quot;json&quot;&lt;/span&gt;] = ret&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    c.ServeJSON()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&quot;完结&quot;&gt;&lt;a href=&quot;#完结&quot; class=&quot;headerlink&quot; title=&quot;完结&quot;&gt;&lt;/a&gt;完结&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;题外话，go很不错，只是还没玩明白啊，继续挖坑&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      跨域登录态共享
    
    </summary>
    
      <category term="web" scheme="http://blog.newbmiao.com/categories/web/"/>
    
      <category term="practice" scheme="http://blog.newbmiao.com/categories/web/practice/"/>
    
    
      <category term="cors" scheme="http://blog.newbmiao.com/tags/cors/"/>
    
      <category term="go" scheme="http://blog.newbmiao.com/tags/go/"/>
    
  </entry>
  
  <entry>
    <title>laradock开发实践</title>
    <link href="http://blog.newbmiao.com/2017/03/14/laradock-in-action.html"/>
    <id>http://blog.newbmiao.com/2017/03/14/laradock-in-action.html</id>
    <published>2017-03-14T07:27:27.000Z</published>
    <updated>2017-03-14T08:27:14.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;此文是我用marp展示ppt拿过来的，可能看着不太明白，抱歉，我太懒~&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;laradock&quot;&gt;&lt;a href=&quot;#laradock&quot; class=&quot;headerlink&quot; title=&quot;laradock&quot;&gt;&lt;/a&gt;laradock&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;h3 id=&quot;DIY-do-it-yourself&quot;&gt;&lt;a href=&quot;#DIY-do-it-yourself&quot; class=&quot;headerlink&quot; title=&quot;DIY(do it yourself)&quot;&gt;&lt;/a&gt;DIY(do it yourself)&lt;/h3&gt;&lt;/li&gt;
&lt;li&gt;&lt;h3 id=&quot;DRY-dont-repeat-youself&quot;&gt;&lt;a href=&quot;#DRY-dont-repeat-youself&quot; class=&quot;headerlink&quot; title=&quot;DRY(dont repeat youself)&quot;&gt;&lt;/a&gt;DRY(dont repeat youself)&lt;/h3&gt;&lt;/li&gt;
&lt;li&gt;&lt;h3 id=&quot;人生苦短，我用docker&quot;&gt;&lt;a href=&quot;#人生苦短，我用docker&quot; class=&quot;headerlink&quot; title=&quot;人生苦短，我用docker&quot;&gt;&lt;/a&gt;人生苦短，我用docker&lt;/h3&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;特点&quot;&gt;&lt;a href=&quot;#特点&quot; class=&quot;headerlink&quot; title=&quot;特点&quot;&gt;&lt;/a&gt;特点&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;易组合：在PHP版本切换、数据库引擎、软件组合&lt;/li&gt;
&lt;li&gt;分而治之：一个软件，一个容器，比如：PHP-FPM, NGINX, PHP-CLI…&lt;/li&gt;
&lt;li&gt;可信镜像：所有镜像继承自一个官方基础镜像（Trusted base Images）&lt;/li&gt;
&lt;li&gt;方便配置，且使用最新Docker Compose&lt;/li&gt;
&lt;li&gt;每周都会有更新…&lt;/li&gt;
&lt;li&gt;&lt;del&gt;快速的镜像构建&lt;/del&gt;(GFW)&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/laradock/laradock/blob/master/README-zh.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;文档&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&quot;docker是什么&quot;&gt;&lt;a href=&quot;#docker是什么&quot; class=&quot;headerlink&quot; title=&quot;docker是什么&quot;&gt;&lt;/a&gt;docker是什么&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2013年初开源项目，基于go语言&lt;/li&gt;
&lt;li&gt;轻量级&lt;/li&gt;
&lt;li&gt;操作系统虚拟化&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&quot;对比传统虚拟机总结&quot;&gt;&lt;a href=&quot;#对比传统虚拟机总结&quot; class=&quot;headerlink&quot; title=&quot;对比传统虚拟机总结&quot;&gt;&lt;/a&gt;对比传统虚拟机总结&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;特性&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;容器&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;虚拟机&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;启动&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;秒级&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;分钟级&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;硬盘使用&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;一般为 MB&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;一般为 GB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;性能&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;接近原生&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;弱于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;系统支持量&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;单机支持上千个容&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;一般几十个&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;p&gt;&lt;img src=&quot;http://media.newbmiao.com/blog/virtualization.png&quot; alt=&quot;虚拟机&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://media.newbmiao.com/blog/docker.png&quot; alt=&quot;docker&quot;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;三个基本概念&quot;&gt;&lt;a href=&quot;#三个基本概念&quot; class=&quot;headerlink&quot; title=&quot;三个基本概念&quot;&gt;&lt;/a&gt;三个基本概念&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;镜像（Image）&lt;/li&gt;
&lt;li&gt;容器（Container）&lt;/li&gt;
&lt;li&gt;仓库（Repository）&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;镜像是只读的，容器在启动的时候创建一层可写层作为最上层。&lt;br&gt;注意一个镜像不能超过 127 层&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.docker.com/engine/installation/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;安装&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&quot;常用命令&quot;&gt;&lt;a href=&quot;#常用命令&quot; class=&quot;headerlink&quot; title=&quot;常用命令&quot;&gt;&lt;/a&gt;常用命令&lt;/h2&gt;&lt;figure class=&quot;highlight crmsh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#镜像&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker images &lt;span class=&quot;comment&quot;&gt;#列出本地镜像&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker rmi training/sinatra &lt;span class=&quot;comment&quot;&gt;#删除（在删除镜像之前要先用 docker rm 删掉依赖于这个镜像的所有容器）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker run -t -i ubuntu:&lt;span class=&quot;number&quot;&gt;14.04&lt;/span&gt; /bin/bash &lt;span class=&quot;comment&quot;&gt;#&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker commit -m &lt;span class=&quot;string&quot;&gt;&quot;Added json gem&quot;&lt;/span&gt; -a &lt;span class=&quot;string&quot;&gt;&quot;Docker Newbee&quot;&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;b2616b0e5a8 ouruser/sinatra:v2 &lt;span class=&quot;comment&quot;&gt;#更新镜像&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker &lt;span class=&quot;keyword&quot;&gt;tag&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;5db5f8471261&lt;/span&gt; ouruser/sinatra:devel &lt;span class=&quot;comment&quot;&gt;#修改标签&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker build $&amp;#123;dockerfile_dir&amp;#125; &lt;span class=&quot;comment&quot;&gt;#Dockerfile 构建&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker save -o ubuntu_14.&lt;span class=&quot;number&quot;&gt;04&lt;/span&gt;.tar ubuntu:&lt;span class=&quot;number&quot;&gt;14.04&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;#保存&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker load --input ubuntu_14.&lt;span class=&quot;number&quot;&gt;04&lt;/span&gt;.tar &lt;span class=&quot;comment&quot;&gt;#导入&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#容器&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker ps &lt;span class=&quot;comment&quot;&gt;#查看容器信息&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker rm &lt;span class=&quot;comment&quot;&gt;#删掉容器（-f 删除运行中）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker inspect &lt;span class=&quot;comment&quot;&gt;#查看指定容器详细信息（可获取ip，pid等信息）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker logs insane_babbage &lt;span class=&quot;comment&quot;&gt;#查看容器log&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker port CONTAINER [PRIVATE_PORT[/PROTO]] &lt;span class=&quot;comment&quot;&gt;#查看端口映射&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker &lt;span class=&quot;literal&quot;&gt;start&lt;/span&gt;|&lt;span class=&quot;literal&quot;&gt;stop&lt;/span&gt;|restart insane_babbage &lt;span class=&quot;comment&quot;&gt;#启动终止重启&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker attach insane_babbage &lt;span class=&quot;comment&quot;&gt;#进入后台运行的容器 -d（推荐nsenter）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker export &lt;span class=&quot;number&quot;&gt;7691&lt;/span&gt;a814370e &amp;gt; ubuntu.tar &lt;span class=&quot;comment&quot;&gt;#导出快照&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cat ubuntu.tar | sudo docker import - test/ubuntu:v1.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;#导入快照&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## docker hub &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker search &lt;span class=&quot;comment&quot;&gt;#搜索镜像&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker pull &lt;span class=&quot;comment&quot;&gt;#下载&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker push &lt;span class=&quot;comment&quot;&gt;#推送（需登录）&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&quot;laradock的结构&quot;&gt;&lt;a href=&quot;#laradock的结构&quot; class=&quot;headerlink&quot; title=&quot;laradock的结构&quot;&gt;&lt;/a&gt;laradock的结构&lt;/h2&gt;&lt;figure class=&quot;highlight 1c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;├── laradock &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── _guides&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── docker-compose.yml &lt;span class=&quot;meta&quot;&gt;#compose 配置&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── docs&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── elasticsearch&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── hhvm&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── logs  &lt;span class=&quot;meta&quot;&gt;#nginx日志；xdebug日志&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── mariadb&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── memcached&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── mongo&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── mysql&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── nginx &lt;span class=&quot;meta&quot;&gt;# nginx 容器配置&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── php-fpm &lt;span class=&quot;meta&quot;&gt;#php-fpm 容器配置&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── phpmyadmin&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── rabbitmq&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── redis&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   ├── workspace &lt;span class=&quot;meta&quot;&gt;#工作台&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│   └── xdebugPhpFpm &lt;span class=&quot;meta&quot;&gt;#动态设置 xdebug 是否启用（需 build 时先安装）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;└── website &lt;span class=&quot;meta&quot;&gt;#网站项目&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    ├── afp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    ├── ams&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    ├── inncms&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&quot;彩蛋&quot;&gt;&lt;a href=&quot;#彩蛋&quot; class=&quot;headerlink&quot; title=&quot;彩蛋&quot;&gt;&lt;/a&gt;彩蛋&lt;/h2&gt;&lt;h3 id=&quot;快捷操作&quot;&gt;&lt;a href=&quot;#快捷操作&quot; class=&quot;headerlink&quot; title=&quot;快捷操作&quot;&gt;&lt;/a&gt;快捷操作&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://raw.githubusercontent.com/yeasy/docker_practice/master/_local/.bashrc_docker&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;docker快捷命令：.bashrc_docker&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;xdebug监听不变的host-ip&quot;&gt;&lt;a href=&quot;#xdebug监听不变的host-ip&quot; class=&quot;headerlink&quot; title=&quot;xdebug监听不变的host ip&quot;&gt;&lt;/a&gt;xdebug监听不变的host ip&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/22944631/how-to-get-the-ip-address-of-the-docker-host-from-inside-a-docker-container/39026136#39026136&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;set host ip never changed&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;本地dns泛解析&quot;&gt;&lt;a href=&quot;#本地dns泛解析&quot; class=&quot;headerlink&quot; title=&quot;本地dns泛解析&quot;&gt;&lt;/a&gt;本地dns泛解析&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.netsh.org/posts/mac-os-x-dnsmasq_1762.netsh.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;hosts泛解析&lt;/a&gt;&lt;br&gt;&lt;figure class=&quot;highlight gradle&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;# 这里ams不是laravel框架，我做了过滤&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;server_name ~^(?&amp;lt;&lt;span class=&quot;keyword&quot;&gt;project&lt;/span&gt;&amp;gt;\b(?!ams\b).+)\.laradock\.dev$;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;root &lt;span class=&quot;regexp&quot;&gt;/var/&lt;/span&gt;www&lt;span class=&quot;regexp&quot;&gt;/$project/&lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h4 id=&quot;安装操作&quot;&gt;&lt;a href=&quot;#安装操作&quot; class=&quot;headerlink&quot; title=&quot;安装操作&quot;&gt;&lt;/a&gt;安装操作&lt;/h4&gt;&lt;figure class=&quot;highlight gauss&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# 安装 dnsmasq&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;brew install dnsmasq&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo cp -v $(brew --prefix dnsmasq)/homebrew.mxcl.dnsmasq.plist /&lt;span class=&quot;keyword&quot;&gt;Library&lt;/span&gt;/LaunchDaemons&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# 添加本地dns解析服务器&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;[ -d /etc/resolver ] || sudo mkdir -v /etc/resolver&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo bash -c &#39;echo &lt;span class=&quot;string&quot;&gt;&quot;nameserver 127.0.0.1&quot;&lt;/span&gt; &amp;gt; /etc/resolver/dev&#39;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# 配置泛解析 (域名后缀自行指定，这里为 .dev)&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo mkdir -p $(brew --prefix)/etc/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cat &amp;gt; $(brew --prefix)/etc/dnsmasq.conf &amp;lt;&amp;lt;-&lt;span class=&quot;built_in&quot;&gt;EOF&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;listen-address=&lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;address=/.dev/&lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# keep nameserver order of resolv.conf&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;strict-order&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;EOF&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# 启用dnsmasq&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo launchctl &lt;span class=&quot;keyword&quot;&gt;load&lt;/span&gt; -w /&lt;span class=&quot;keyword&quot;&gt;Library&lt;/span&gt;/LaunchDaemons/homebrew.mxcl.dnsmasq.plist&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# 若更新dnsmasq后，需重启以应用&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo launchctl &lt;span class=&quot;keyword&quot;&gt;stop&lt;/span&gt; homebrew.mxcl.dnsmasq&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo launchctl start homebrew.mxcl.dnsmasq&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo killall -HUP mDNSResponder&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&quot;End&quot;&gt;&lt;a href=&quot;#End&quot; class=&quot;headerlink&quot; title=&quot;End&quot;&gt;&lt;/a&gt;End&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;docker for mac&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.docker.com/docker-for-mac/install/#download-docker-for-mac&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;安装&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;基于开发的一些修改（踩坑）&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;git@github.com:NewbMiao/laradock.git (dev分支，master定期手动同步官方分支)&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;xdebug 配置&lt;/li&gt;
&lt;li&gt;全局安装composer及&lt;code&gt;hirak/prestissimo&lt;/code&gt;(可加速composer）&lt;/li&gt;
&lt;li&gt;ssh开启 可配合phpstorm 指定CLI interpreter&lt;/li&gt;
&lt;li&gt;关闭nginx &lt;code&gt;open_file_cache&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;composer国内地址替换；aliyun源替换&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;git@github.com:laradock/laradock.git （官方分支）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;能番羽墙最好，不然，可以参考下边&lt;/p&gt;
&lt;figure class=&quot;highlight vala&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;## apt-get替换源&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# 另外，在国内使用 docker（以 ubuntu 为例）， Dockerfile 第一个执行的命令最好为：&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;RUN sed -i &lt;span class=&quot;string&quot;&gt;&#39;s/archive.ubuntu.com/mirrors.aliyun.com/g&#39;&lt;/span&gt; /etc/apt/sources.list \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;amp;&amp;amp; apt-&lt;span class=&quot;keyword&quot;&gt;get&lt;/span&gt; update --fix-missing \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;amp;&amp;amp; apt-&lt;span class=&quot;keyword&quot;&gt;get&lt;/span&gt; -y upgrade&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;## composer替换源&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;RUN composer config -g repo.packagist composer https:&lt;span class=&quot;comment&quot;&gt;//packagist.phpcomposer.com&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;## ssh workspace（推荐还是exec方式）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;chmod &lt;span class=&quot;number&quot;&gt;0600&lt;/span&gt; workspace/insecure_id_rsa&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ssh -i workspace/insecure_id_rsa -v root@laradock.dev -p2222&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      laradock开发实践
    
    </summary>
    
      <category term="php" scheme="http://blog.newbmiao.com/categories/php/"/>
    
      <category term="tool" scheme="http://blog.newbmiao.com/categories/php/tool/"/>
    
    
      <category term="php" scheme="http://blog.newbmiao.com/tags/php/"/>
    
      <category term="laradock" scheme="http://blog.newbmiao.com/tags/laradock/"/>
    
      <category term="docker" scheme="http://blog.newbmiao.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>imagick中文自动换行和base64串上传图片</title>
    <link href="http://blog.newbmiao.com/2017/02/17/auto-wrap-chinese-use-imagick-and-upload-image-by-base64-encode-str.html"/>
    <id>http://blog.newbmiao.com/2017/02/17/auto-wrap-chinese-use-imagick-and-upload-image-by-base64-encode-str.html</id>
    <published>2017-02-17T08:17:26.000Z</published>
    <updated>2017-02-17T08:50:23.000Z</updated>
    
    <content type="html">&lt;p&gt;本文分享两个:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;imagick中中文自动换行&lt;/li&gt;
&lt;li&gt;base64串的图片上传&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;没啥太大关联，只是工作用到记录下，供需要的用&lt;/p&gt;
&lt;h2 id=&quot;imagick中中文自动换行&quot;&gt;&lt;a href=&quot;#imagick中中文自动换行&quot; class=&quot;headerlink&quot; title=&quot;imagick中中文自动换行&quot;&gt;&lt;/a&gt;imagick中中文自动换行&lt;/h2&gt;&lt;p&gt;首先是imgick的类库使用推荐 &lt;a href=&quot;https://github.com/Intervention/image&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Intervention/image&lt;/a&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;$canvas = Image::canvas(&lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;#e2e2e2&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;$txt = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;::autoWrap($fontSize, &lt;span class=&quot;string&quot;&gt;&#39;./msyh.ttf&#39;&lt;/span&gt;, $text,$lineWidth);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//$txt = array_slice(explode(PHP_EOL, $txt), 0, 2);//这里是处理需要显示几行&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//$txt = implode(PHP_EOL, $txt);&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//这里x，y设置为要显示文字左上角线的中心点坐标就可以，$font-&amp;gt;align(&#39;center&#39;);会自动让文字左右居中&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;$canvas-&amp;gt;text($txt, $x, $y, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;(Font $font)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;($t)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $font-&amp;gt;file(&lt;span class=&quot;string&quot;&gt;&#39;./msyh.ttf&#39;&lt;/span&gt;);&lt;span class=&quot;comment&quot;&gt;//imgick作为driver需配置字体文件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $font-&amp;gt;size($t[&lt;span class=&quot;string&quot;&gt;&#39;size&#39;&lt;/span&gt;]);&lt;span class=&quot;comment&quot;&gt;//$t是字体相关配置&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $font-&amp;gt;color($t[&lt;span class=&quot;string&quot;&gt;&#39;color&#39;&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $font-&amp;gt;align(&lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $font-&amp;gt;valign(&lt;span class=&quot;string&quot;&gt;&#39;top&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重点是如何计算每个字的长度,然后通过行宽断句&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * 根据预设宽度让文字自动换行&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; int $fontsize 字体大小&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; string $ttfpath 字体名称&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; string $str 字符串&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; int $width 预设宽度&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; int $fontangle 角度&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; string $charset 编码&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@return&lt;/span&gt; string $_string  字符串&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;autoWrap&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($fontsize, $ttfpath, $str, $width, $fontangle = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, $charset = &lt;span class=&quot;string&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $_string = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $_width = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $temp = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;::chararray($str, $charset);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;foreach&lt;/span&gt; ($temp[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; $v) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        $w = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;::charWidth($fontsize, $fontangle, $v, $ttfpath);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        $_width += intval($w);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (($_width &amp;gt; $width) &amp;amp;&amp;amp; ($v !== &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            $_string .= PHP_EOL;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            $_width = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        $_string .= $v;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $_string;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * 返回一个字符的数组&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; *&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; string $str 文字&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; string $charset 字符编码&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@return&lt;/span&gt; array $match   返回一个字符的数组&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;charArray&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($str, $charset = &lt;span class=&quot;string&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $re[&lt;span class=&quot;string&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&quot;/[\x01-\x7f]|[\xc2-\xdf][\x80-\xbf]|[\xe0-\xef][\x80-\xbf]&amp;#123;2&amp;#125;|[\xf0-\xff][\x80-\xbf]&amp;#123;3&amp;#125;/&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $re[&lt;span class=&quot;string&quot;&gt;&#39;gb2312&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&quot;/[\x01-\x7f]|[\xb0-\xf7][\xa0-\xfe]/&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $re[&lt;span class=&quot;string&quot;&gt;&#39;gbk&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&quot;/[\x01-\x7f]|[\x81-\xfe][\x40-\xfe]/&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $re[&lt;span class=&quot;string&quot;&gt;&#39;big5&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&quot;/[\x01-\x7f]|[\x81-\xfe]([\x40-\x7e]|\xa1-\xfe])/&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    preg_match_all($re[$charset], $str, $match);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $match;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * 返回一个字符串在图片中所占的宽度&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; int $fontsize 字体大小&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; int $fontangle 角度&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; string $ttfpath 字体文件&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; string $char 字符&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@return&lt;/span&gt; int $width&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;charWidth&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($fontsize, $fontangle, $char, $ttfpath)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $box = @imagettfbbox($fontsize, $fontangle, $ttfpath, $char);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $width = max($box[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;], $box[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;]) - min($box[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], $box[&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $width;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;base64串的图片上传&quot;&gt;&lt;a href=&quot;#base64串的图片上传&quot; class=&quot;headerlink&quot; title=&quot;base64串的图片上传&quot;&gt;&lt;/a&gt;base64串的图片上传&lt;/h2&gt;&lt;p&gt;这里我合成图片调用&lt;code&gt;$img-&amp;gt;encode(&amp;#39;data-url&amp;#39;)&lt;/code&gt;输出前台预览图片，&lt;br&gt;确认后才上传，为了方便就直接那base64串转blob上传&lt;/p&gt;
&lt;p&gt;为了通用，如果你想搞个大的，比方说&lt;strong&gt;直接将页面的某个图片上传&lt;/strong&gt;，可以参考一下代码&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//base64串转blob&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getBlob&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;dataURI&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; byteString = atob(dataURI.split(&lt;span class=&quot;string&quot;&gt;&#39;,&#39;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; mimeString = dataURI.split(&lt;span class=&quot;string&quot;&gt;&#39;,&#39;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].split(&lt;span class=&quot;string&quot;&gt;&#39;:&#39;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;].split(&lt;span class=&quot;string&quot;&gt;&#39;;&#39;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ia = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Uint8Array&lt;/span&gt;(byteString.length);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; byteString.length; i++) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    ia[i] = byteString.charCodeAt(i);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Blob([ia], &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    type: mimeString&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//图片直接转data-url&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getBase64Image&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;img, quality&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; canvas = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElement(&lt;span class=&quot;string&quot;&gt;&quot;canvas&quot;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!quality) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    quality = &lt;span class=&quot;number&quot;&gt;0.6&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  canvas.width = img.naturalWidth;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  canvas.height = img.naturalHeight;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  canvas.getContext(&lt;span class=&quot;string&quot;&gt;&quot;2d&quot;&lt;/span&gt;).drawImage(img, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; canvas.toDataURL(&lt;span class=&quot;string&quot;&gt;&quot;image/jpeg&quot;&lt;/span&gt;, quality);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//图片直接上传&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;upload&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;imgObj, callback&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; blob = getBlob(getBase64Image(imgObj));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; apiUrl = &lt;span class=&quot;string&quot;&gt;&#39;xxx&#39;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; fd = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; FormData();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  fd.append(&lt;span class=&quot;string&quot;&gt;&#39;image&#39;&lt;/span&gt;, blob);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  $.ajax(&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    url: apiUrl,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    dataType: &lt;span class=&quot;string&quot;&gt;&#39;json&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    cache: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    contentType: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    processData: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    data: fd,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    type: &lt;span class=&quot;string&quot;&gt;&#39;post&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    success: callback&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      imagick中文自动换行和base64串上传图片
    
    </summary>
    
      <category term="php" scheme="http://blog.newbmiao.com/categories/php/"/>
    
    
      <category term="imgick" scheme="http://blog.newbmiao.com/tags/imgick/"/>
    
      <category term="json" scheme="http://blog.newbmiao.com/tags/json/"/>
    
      <category term="blob" scheme="http://blog.newbmiao.com/tags/blob/"/>
    
  </entry>
  
  <entry>
    <title>php踩坑记录</title>
    <link href="http://blog.newbmiao.com/2016/11/08/some-misuse-of-php.html"/>
    <id>http://blog.newbmiao.com/2016/11/08/some-misuse-of-php.html</id>
    <published>2016-11-08T11:33:22.000Z</published>
    <updated>2017-01-19T08:34:55.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;函数&quot;&gt;&lt;a href=&quot;#函数&quot; class=&quot;headerlink&quot; title=&quot;函数&quot;&gt;&lt;/a&gt;函数&lt;/h1&gt;&lt;h2 id=&quot;mb-strlen-不生效&quot;&gt;&lt;a href=&quot;#mb-strlen-不生效&quot; class=&quot;headerlink&quot; title=&quot;mb_strlen 不生效&quot;&gt;&lt;/a&gt;mb_strlen 不生效&lt;/h2&gt;&lt;p&gt;有一天发现本地&lt;code&gt;mb_strlen(&amp;#39;哈&amp;#39;)&lt;/code&gt;本地为1,服务器为3,猜测应该是配置问题&lt;br&gt;看文档关键在于&lt;code&gt;mb_internal_encoding&lt;/code&gt;&lt;br&gt;&lt;figure class=&quot;highlight applescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mixed mb_strlen ( &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt; $str [, &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt; $encoding = mb_internal_encoding() ] )&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;继续搜 mbstring.internal_encoding (定义内部字符的默认编码)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Warning: This feature has been DEPRECATED &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; PHP &lt;span class=&quot;number&quot;&gt;5.6&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;. Relying &lt;span class=&quot;keyword&quot;&gt;on&lt;/span&gt; this feature &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; highly discouraged.。&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;PHP &lt;span class=&quot;number&quot;&gt;5.6&lt;/span&gt; 及更新版的用户应该将此选项留空，并设置 default_charset 作为代替。&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;好吧，服务器 default_charset 没设置，然后默认用 ISO&lt;span class=&quot;number&quot;&gt;-8859&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;解决方案：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;//入口设置，有权限的话也可以 ini_&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;default_charset&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;UTF-8&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mb_internal_encoding(&lt;span class=&quot;string&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;解决方案&quot;&gt;&lt;a href=&quot;#解决方案&quot; class=&quot;headerlink&quot; title=&quot;解决方案&quot;&gt;&lt;/a&gt;解决方案&lt;/h1&gt;&lt;h2 id=&quot;session文件锁&quot;&gt;&lt;a href=&quot;#session文件锁&quot; class=&quot;headerlink&quot; title=&quot;session文件锁&quot;&gt;&lt;/a&gt;session文件锁&lt;/h2&gt;&lt;p&gt;并发下，php是不推荐用文件存储的方式管理session的，因为session管理有 【读写锁】！！！附干活两篇&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://log.zvz.im/2016/02/27/PHP-session/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PHP session锁：如何避免session阻塞PHP请求&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://laravel-china.org/topics/1093&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;关于 PHP 中 Session 的几个问题&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      php踩坑记录
    
    </summary>
    
      <category term="php" scheme="http://blog.newbmiao.com/categories/php/"/>
    
    
      <category term="php" scheme="http://blog.newbmiao.com/tags/php/"/>
    
      <category term="function" scheme="http://blog.newbmiao.com/tags/function/"/>
    
  </entry>
  
  <entry>
    <title>jquery多异步管理使用记录</title>
    <link href="http://blog.newbmiao.com/2016/11/08/jquery-multi-async-manage-note.html"/>
    <id>http://blog.newbmiao.com/2016/11/08/jquery-multi-async-manage-note.html</id>
    <published>2016-11-08T11:27:05.000Z</published>
    <updated>2016-11-08T11:38:44.000Z</updated>
    
    <content type="html">&lt;p&gt;先记录一些参考文章&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.ruanyifeng.com/blog/2012/12/asynchronous%EF%BC%BFjavascript.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javascript异步编程的4种方法(阮一峰)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://borninsummer.com/2015/06/02/using-promise-to-carry-out-multi-ajax-procedure/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;用Promise实现多个Ajax的异步流程控制&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://xifengxx.github.io/2016/05/04/jQuery%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B08/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;jQuery的AJAX方法(全局)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://es6.ruanyifeng.com/#docs/promise&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Promise对象(ES6)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;when-传递多个deferred&quot;&gt;&lt;a href=&quot;#when-传递多个deferred&quot; class=&quot;headerlink&quot; title=&quot;$.when() 传递多个deferred&quot;&gt;&lt;/a&gt;$.when() 传递多个deferred&lt;/h3&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;var ajaxBatch=[];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;regexp&quot;&gt;//&lt;/span&gt;构建deferred数组&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;...&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$.&lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;when&lt;/span&gt;.apply(&lt;span class=&quot;variable&quot;&gt;$,&lt;/span&gt; ajaxBatch).done();&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;done-callback内arguments结构不一致&quot;&gt;&lt;a href=&quot;#done-callback内arguments结构不一致&quot; class=&quot;headerlink&quot; title=&quot;done() callback内arguments结构不一致&quot;&gt;&lt;/a&gt;done() callback内arguments结构不一致&lt;/h3&gt;&lt;p&gt;就是会有三种情况：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;无参数&lt;/li&gt;
&lt;li&gt;$.when()一个deferred参数: [data, textStatus , jqXHR] #假定 x代表[data,textStatus,jqXHR]结构&lt;/li&gt;
&lt;li&gt;$.when()多个deferred参数: [x1,x2,x3]&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;是不是醉了，怎么统一处理？&lt;br&gt;目前使用判断最里层data的结构&lt;br&gt;&lt;figure class=&quot;highlight markdown&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;.done(function()&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  var params=[].slice.call(arguments);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  if(typeof params[&lt;span class=&quot;string&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;symbol&quot;&gt;0&lt;/span&gt;] !=&#39;object&#39;)&amp;#123; //第二种情况返回undefined&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;code&quot;&gt;      params=[];&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;code&quot;&gt;      params[0]=[].slice.call(arguments);&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  //然后遍历结果吧&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/a/28365429/4431337&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;stackoverflow&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.odoo.com/documentation/8.0/reference/async.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Asynchronous Operations&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;同步UI阻塞弹出层提示&quot;&gt;&lt;a href=&quot;#同步UI阻塞弹出层提示&quot; class=&quot;headerlink&quot; title=&quot;同步UI阻塞弹出层提示&quot;&gt;&lt;/a&gt;同步UI阻塞弹出层提示&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://jsfiddle.net/newbmiao/77xyhjjj/4/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;弹出层成功回调中使用setTimeout延时&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      jquery多异步管理使用记录
    
    </summary>
    
      <category term="js" scheme="http://blog.newbmiao.com/categories/js/"/>
    
      <category term="jquery" scheme="http://blog.newbmiao.com/categories/js/jquery/"/>
    
    
      <category term="js" scheme="http://blog.newbmiao.com/tags/js/"/>
    
      <category term="jquery" scheme="http://blog.newbmiao.com/tags/jquery/"/>
    
      <category term="ajax" scheme="http://blog.newbmiao.com/tags/ajax/"/>
    
      <category term="promise" scheme="http://blog.newbmiao.com/tags/promise/"/>
    
  </entry>
  
  <entry>
    <title>jquery-timepicker-addon动态显示使用</title>
    <link href="http://blog.newbmiao.com/2016/09/07/how-to-dynamic-show-jquery-timepicker-addon.html"/>
    <id>http://blog.newbmiao.com/2016/09/07/how-to-dynamic-show-jquery-timepicker-addon.html</id>
    <published>2016-09-07T03:26:24.000Z</published>
    <updated>2016-09-28T07:53:32.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://trentrichardson.com/examples/timepicker/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;文档&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;需要分条件判断是否显示时间选择，而timepicker是单例模式，&lt;br&gt;初始化只有第一次生效，要想实时更新需要用到&lt;code&gt;option&lt;/code&gt;选项设置&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// #cond是条件选择select，带.selectDateInput的是两个时间选择输入框&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;$(&lt;span class=&quot;string&quot;&gt;&#39;#cond&#39;&lt;/span&gt;).change(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;//设置默认显示&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; defaultOption = &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    timeFormat: &lt;span class=&quot;string&quot;&gt;&quot;HH:mm:ss&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    dateFormat: &lt;span class=&quot;string&quot;&gt;&quot;yy-mm-dd&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;//获取分组对应时间(小时)，是否显示时间选择&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; startHour = &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; enableTimePicker = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;//设置时间控件（防止直接输入时间）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  $(&lt;span class=&quot;string&quot;&gt;&#39;.selectDateInput&#39;&lt;/span&gt;).prop(&lt;span class=&quot;string&quot;&gt;&#39;readonly&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;readonly&#39;&lt;/span&gt;).val(&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!enableTimePicker) &amp;#123; &lt;span class=&quot;comment&quot;&gt;//不允许选择时间&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; startOption = &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      hour: startHour, &lt;span class=&quot;comment&quot;&gt;//设置初始时间&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      showHour: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      showMinute: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      timeInput: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;//是否允许时间编辑&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      disabled: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;//是否禁用控件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      onSelect: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;selectedDateTime&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//选中后设置默认初始小时和结束时间（次日24小时后）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        selectedDateTime = selectedDateTime.split(&lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + &lt;span class=&quot;string&quot;&gt;&quot; 00:00:00&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; startDate = (&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt;(selectedDateTime));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//setDate设置时间&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).datetimepicker(&lt;span class=&quot;string&quot;&gt;&#39;setDate&#39;&lt;/span&gt;, selectedDateTime + &lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt; + startHour + &lt;span class=&quot;string&quot;&gt;&quot;:00:00&quot;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        startDate.setTime(startDate.getTime() + &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt; * &lt;span class=&quot;number&quot;&gt;3600&lt;/span&gt; * (&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt; + startHour) - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//格式化时间显示&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; endDateStr = startDate.toLocaleString(&lt;span class=&quot;string&quot;&gt;&#39;zh-CN&#39;&lt;/span&gt;, &amp;#123;hour12: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&amp;#125;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                .replace(&lt;span class=&quot;regexp&quot;&gt;/\//g&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;-&#39;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                .replace(&lt;span class=&quot;regexp&quot;&gt;/\b\d\b/g&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;0$&amp;amp;&#39;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;//添加前导零&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        $(&lt;span class=&quot;string&quot;&gt;&#39;.selectDateInput:eq(1)&#39;&lt;/span&gt;).val(endDateStr);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $(&lt;span class=&quot;string&quot;&gt;&#39;.selectDateInput:eq(0)&#39;&lt;/span&gt;).datetimepicker(defaultOption)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      .datetimepicker(&lt;span class=&quot;string&quot;&gt;&#39;option&#39;&lt;/span&gt;, startOption); &lt;span class=&quot;comment&quot;&gt;//option更新（可实时刷新显示）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $(&lt;span class=&quot;string&quot;&gt;&#39;.selectDateInput:eq(1)&#39;&lt;/span&gt;).datetimepicker()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      .datetimepicker(&lt;span class=&quot;string&quot;&gt;&#39;option&#39;&lt;/span&gt;, &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        disabled: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;//禁用第二个时间选择输入框&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      &amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123; &lt;span class=&quot;comment&quot;&gt;//时间选择显示&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $(&lt;span class=&quot;string&quot;&gt;&#39;.selectDateInput&#39;&lt;/span&gt;).datetimepicker(defaultOption)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      .datetimepicker(&lt;span class=&quot;string&quot;&gt;&#39;option&#39;&lt;/span&gt;, &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        showHour: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        showMinute: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        timeInput: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        disabled: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        onSelect: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      &amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;).trigger(&lt;span class=&quot;string&quot;&gt;&#39;change&#39;&lt;/span&gt;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;为了实现动态显示折腾了好久，以后查资料还是要多看看官方api和 stackOverFlow 了。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;附推荐&lt;a href=&quot;http://www.cnblogs.com/yigeqi/p/4031393.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;js正则一篇&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      jquery-timepicker-addon动态显示使用
    
    </summary>
    
      <category term="js" scheme="http://blog.newbmiao.com/categories/js/"/>
    
      <category term="jquery" scheme="http://blog.newbmiao.com/categories/js/jquery/"/>
    
    
      <category term="js" scheme="http://blog.newbmiao.com/tags/js/"/>
    
      <category term="jquery-timepicker-addon" scheme="http://blog.newbmiao.com/tags/jquery-timepicker-addon/"/>
    
  </entry>
  
  <entry>
    <title>js如何动态调用不确定参数的函数</title>
    <link href="http://blog.newbmiao.com/2016/08/17/how-to-call-a-function-with-unsure-number-params.html"/>
    <id>http://blog.newbmiao.com/2016/08/17/how-to-call-a-function-with-unsure-number-params.html</id>
    <published>2016-08-17T06:17:31.000Z</published>
    <updated>2016-08-17T10:43:32.000Z</updated>
    
    <content type="html">&lt;figure class=&quot;highlight actionscript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//需求：想通过传函数体和参数去调用，但不确定参数（就是说不想写死参数）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//比方m这个函数可能会改成需要4个，8个参数，但不想改动态调用它的函数&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; m = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(a, b, c)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a + b + c;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//this is solution&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//apply+arguments 把参数数组动态传递给函数体&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;makeFunc&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; args = &lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.prototype.slice.call(&lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; func = args.shift();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; func.apply(&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;, args.concat(&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.prototype.slice.call(&lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;)));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;m2 = makeFunc(m, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;//缺的参数也可以在附加（注意concat的调用，叠加了参数数组）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(m2(&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;)); &lt;span class=&quot;comment&quot;&gt;//多余的参数7不会被用到&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//简化&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//Array.prototype.slice可以用[].slice替换&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//题外话：意外遇到一个上下文调用的错误=_=！&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; p = &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;//error: Uncaught TypeError: Illegal invocation（在控制台查看）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;p.apply(&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;, [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]); &lt;span class=&quot;comment&quot;&gt;//ok&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//小心的坑：&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// makeFunc的apply设置上下文是null，所以有依赖上下文的函数需考虑传不依赖上下文的函数体，必要时可以构造匿名函数&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//遇到的问题！（没搞明白）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// function()&amp;#123;$(&#39;#app&#39;).show();&amp;#125; //显示弹框，直接传$(&#39;#app&#39;).show 会导致无法响应&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      js如何动态调用不确定参数的函数
    
    </summary>
    
      <category term="js" scheme="http://blog.newbmiao.com/categories/js/"/>
    
    
      <category term="js" scheme="http://blog.newbmiao.com/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>mac工具集</title>
    <link href="http://blog.newbmiao.com/2016/03/15/mac-tool.html"/>
    <id>http://blog.newbmiao.com/2016/03/15/mac-tool.html</id>
    <published>2016-03-15T02:50:23.000Z</published>
    <updated>2016-11-22T10:28:39.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;brew&quot;&gt;&lt;a href=&quot;#brew&quot; class=&quot;headerlink&quot; title=&quot;brew&quot;&gt;&lt;/a&gt;brew&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;ruby &lt;span class=&quot;_&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&lt;/span&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;iterm2&quot;&gt;&lt;a href=&quot;#iterm2&quot; class=&quot;headerlink&quot; title=&quot;iterm2&quot;&gt;&lt;/a&gt;iterm2&lt;/h2&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;https:&lt;/span&gt;/&lt;span class=&quot;regexp&quot;&gt;/iterm2.com/downloads&lt;/span&gt;&lt;span class=&quot;regexp&quot;&gt;/stable/i&lt;/span&gt;Term2_v2_&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;.zip&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;运行iterm2之后按cmd+,调出设置界面，在&lt;span class=&quot;string&quot;&gt;&#39;profile&#39;&lt;/span&gt; -&amp;gt; &lt;span class=&quot;string&quot;&gt;&quot;Terminal Type&quot;&lt;/span&gt;改成xterm-new。&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;zsh&quot;&gt;&lt;a href=&quot;#zsh&quot; class=&quot;headerlink&quot; title=&quot;zsh&quot;&gt;&lt;/a&gt;zsh&lt;/h2&gt;&lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;brew install zsh&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo vim &lt;span class=&quot;meta-keyword&quot;&gt;/etc/&lt;/span&gt;shells&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;meta&quot;&gt;#在最后面加上一行&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;meta-keyword&quot;&gt;/usr/&lt;/span&gt;local/Cellar&lt;span class=&quot;meta-keyword&quot;&gt;/zsh/&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.8&lt;/span&gt;&lt;span class=&quot;meta-keyword&quot;&gt;/bin/&lt;/span&gt;zsh&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;chsh -s &lt;span class=&quot;meta-keyword&quot;&gt;/usr/&lt;/span&gt;local/Cellar&lt;span class=&quot;meta-keyword&quot;&gt;/zsh/&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.8&lt;/span&gt;&lt;span class=&quot;meta-keyword&quot;&gt;/bin/&lt;/span&gt;zsh&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#重启终端即可&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;oh-my-zsh&quot;&gt;&lt;a href=&quot;#oh-my-zsh&quot; class=&quot;headerlink&quot; title=&quot;oh-my-zsh&quot;&gt;&lt;/a&gt;oh-my-zsh&lt;/h2&gt;&lt;figure class=&quot;highlight vim&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;curl -L http&lt;span class=&quot;variable&quot;&gt;s:&lt;/span&gt;//raw.github.&lt;span class=&quot;keyword&quot;&gt;com&lt;/span&gt;/robbyrussell/oh-my-zsh/master/tools/install.&lt;span class=&quot;keyword&quot;&gt;sh&lt;/span&gt; | &lt;span class=&quot;keyword&quot;&gt;sh&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;dash-文档工具&quot;&gt;&lt;a href=&quot;#dash-文档工具&quot; class=&quot;headerlink&quot; title=&quot;dash 文档工具&quot;&gt;&lt;/a&gt;dash 文档工具&lt;/h2&gt;&lt;h2 id=&quot;alfred-快捷调用&quot;&gt;&lt;a href=&quot;#alfred-快捷调用&quot; class=&quot;headerlink&quot; title=&quot;alfred 快捷调用&quot;&gt;&lt;/a&gt;alfred 快捷调用&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/zenorocha/alfred-workflows&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;附一个开发必备工具集&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;lrzsz-服务器和本机传输工具&quot;&gt;&lt;a href=&quot;#lrzsz-服务器和本机传输工具&quot; class=&quot;headerlink&quot; title=&quot;lrzsz-服务器和本机传输工具&quot;&gt;&lt;/a&gt;lrzsz-服务器和本机传输工具&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/mmastrac/iterm2-zmodem&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iterm2-zmodem&lt;/a&gt;&lt;br&gt;item2 ssh远程服务器，就能上传下载文件&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;sz 想要本机接收的文件&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;rz 想让远程收到的文件&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;issue：ssl证书验证失败无法下载&lt;/strong&gt;&lt;br&gt;原因是brew https连接失败&lt;br&gt;解决方法：&lt;br&gt;&lt;figure class=&quot;highlight vim&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;sudo &lt;span class=&quot;keyword&quot;&gt;vim&lt;/span&gt; /usr/local/Library/Homebrew/utils.rb&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;修改下面的行加一个-&lt;span class=&quot;keyword&quot;&gt;k&lt;/span&gt; 参数，让 curl 忽略 https 验证&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;args&lt;/span&gt; = [HOMEBREW_CURL_ARGS, HOMEBREW_USER_AGENT,&lt;span class=&quot;string&quot;&gt;&#39;-k&#39;&lt;/span&gt;, *&lt;span class=&quot;keyword&quot;&gt;args&lt;/span&gt;]&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;tldr&quot;&gt;&lt;a href=&quot;#tldr&quot; class=&quot;headerlink&quot; title=&quot;tldr&quot;&gt;&lt;/a&gt;tldr&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/tldr-pages/tldr&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;tldr查询命令如何用&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;how2&quot;&gt;&lt;a href=&quot;#how2&quot; class=&quot;headerlink&quot; title=&quot;how2&quot;&gt;&lt;/a&gt;how2&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/santinic/how2&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;stackoverflow命令行查询工具&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;git-credential-osxkeychain&quot;&gt;&lt;a href=&quot;#git-credential-osxkeychain&quot; class=&quot;headerlink&quot; title=&quot;git-credential-osxkeychain&quot;&gt;&lt;/a&gt;git-credential-osxkeychain&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://help.github.com/articles/caching-your-github-password-in-git/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;免密码提交&lt;/a&gt;&lt;br&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;curl -s -O https:&lt;span class=&quot;comment&quot;&gt;//github-media-downloads.s3.amazonaws.com/osx/git-credential-osxkeychain&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;chmod u+x git-credential-osxkeychain&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo mv git-credential-osxkeychain &lt;span class=&quot;string&quot;&gt;&quot;$(dirname $(which git))/git-credential-osxkeychain&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;git config --global credential&lt;span class=&quot;selector-class&quot;&gt;.helper&lt;/span&gt; osxkeychain&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;mackup&quot;&gt;&lt;a href=&quot;#mackup&quot; class=&quot;headerlink&quot; title=&quot;mackup&quot;&gt;&lt;/a&gt;mackup&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/lra/mackup&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;mackup备份配置&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;推荐  &lt;a href=&quot;http://gooday.xyz/proxifier%E6%B3%A8%E5%86%8C%E7%A0%81%E4%BB%A5%E5%8F%8A%E9%85%8D%E5%90%88shadowsocks%E4%B8%8A%E7%BD%91/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;googledrive+proxifier&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;shortcat&quot;&gt;&lt;a href=&quot;#shortcat&quot; class=&quot;headerlink&quot; title=&quot;shortcat&quot;&gt;&lt;/a&gt;shortcat&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://www.appinn.com/shortcat/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;扔掉你的鼠标&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://blog.magi.site/2016/06/15/shortcat-config-tips/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;配置&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;cheatsheet-amp-EVE-快捷键提示&quot;&gt;&lt;a href=&quot;#cheatsheet-amp-EVE-快捷键提示&quot; class=&quot;headerlink&quot; title=&quot;cheatsheet &amp;amp; EVE 快捷键提示&quot;&gt;&lt;/a&gt;cheatsheet &amp;amp; EVE 快捷键提示&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.mediaatelier.com/CheatSheet/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;cheatsheet&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.hotkey-eve.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;EVE&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;vscode-神编辑器&quot;&gt;&lt;a href=&quot;#vscode-神编辑器&quot; class=&quot;headerlink&quot; title=&quot;vscode 神编辑器&quot;&gt;&lt;/a&gt;vscode 神编辑器&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://code.visualstudio.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;vscode&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      mac,tool
    
    </summary>
    
      <category term="mac" scheme="http://blog.newbmiao.com/categories/mac/"/>
    
      <category term="tool" scheme="http://blog.newbmiao.com/categories/mac/tool/"/>
    
    
      <category term="mac" scheme="http://blog.newbmiao.com/tags/mac/"/>
    
      <category term="tool" scheme="http://blog.newbmiao.com/tags/tool/"/>
    
  </entry>
  
  <entry>
    <title>基于phpstorm和vagrant环境的xdebug远程调试</title>
    <link href="http://blog.newbmiao.com/2015/12/04/xdebug-remote-debug-with-phpstorm-and-vagrant.html"/>
    <id>http://blog.newbmiao.com/2015/12/04/xdebug-remote-debug-with-phpstorm-and-vagrant.html</id>
    <published>2015-12-04T06:01:09.000Z</published>
    <updated>2016-07-07T13:09:22.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;网页调试-本地调试&quot;&gt;&lt;a href=&quot;#网页调试-本地调试&quot; class=&quot;headerlink&quot; title=&quot;网页调试/本地调试&quot;&gt;&lt;/a&gt;网页调试/本地调试&lt;/h2&gt;&lt;p&gt;流程是啥&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;开发环境安装xdebug，配置监听client端（安装phpstorm那端）&lt;/li&gt;
&lt;li&gt;配置phpstorm-debug，重点要用path-map，不然对于单一入口的网页调试找不到哦&lt;/li&gt;
&lt;li&gt;断点跟踪吧&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;详细网上资料很多，下边三个都可以用，我就不赘述了&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://xrong.net/2014/09/09/phpstorm%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;phpstorm远程调试&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://confluence.jetbrains.com/display/PhpStorm/Zero-configuration+Web+Application+Debugging+with+Xdebug+and+PhpStorm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Zero-configuration Web Application Debugging with Xdebug and PhpStorm&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://stackoverflow.com/questions/15339165/cannot-debug-with-phpstorm-vagrant-xdebug&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;cannot-debug-with-phpstorm-vagrant-xdebug&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;远程cli调试&quot;&gt;&lt;a href=&quot;#远程cli调试&quot; class=&quot;headerlink&quot; title=&quot;远程cli调试&quot;&gt;&lt;/a&gt;远程cli调试&lt;/h2&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;上边的不适用于远程cli调试，为什么？&lt;/p&gt;
&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;原理是一样，远程主机的xdebug监听client的phpstorm，但是命令行调试， $_SERVER 中没有serverName和IDE_KEY的值.&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;另外当只起用  xdebug&lt;span class=&quot;selector-class&quot;&gt;.remote_connect_back&lt;/span&gt; = on  不监听指定ip，是需要提供  xdebug&lt;span class=&quot;selector-class&quot;&gt;.remote_host&lt;/span&gt; 的值的。&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;明白了这些，只要配置环境变量值就可以了&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;主要就是 XDEBUG_CONFIG  和 PHP_IDE_CONFIG  （serverName要对应你在phpstorm中配置的server别名）&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#添加下边命令到 ~/.bashrc&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;_phpdebug&lt;/span&gt;&lt;/span&gt;()&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; XDEBUG_CONFIG=&lt;span class=&quot;string&quot;&gt;&quot;remote_host=&lt;span class=&quot;variable&quot;&gt;$(echo $SSH_CLIENT | awk &#39;&amp;#123;print $1&amp;#125;&#39;)&lt;/span&gt; idekey=PHPSTORM&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; PHP_IDE_CONFIG=&lt;span class=&quot;string&quot;&gt;&quot;serverName=cli&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;set XDEBUG_CONFIG=&lt;span class=&quot;variable&quot;&gt;$&amp;#123;XDEBUG_CONFIG&amp;#125;&lt;/span&gt;; PHP_IDE_CONFIG=&lt;span class=&quot;variable&quot;&gt;$&amp;#123;PHP_IDE_CONFIG&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;alias&lt;/span&gt; phpdebug=&lt;span class=&quot;string&quot;&gt;&quot;_phpdebug&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;alias&lt;/span&gt; phpdebugoff=&lt;span class=&quot;string&quot;&gt;&quot;unset PHP_IDE_CONFIG &amp;amp;&amp;amp; unset XDEBUG_CONFIG&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#执行&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; ~/.bashrc&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;以后调试前只要在vagrant或远程主机先执行 &lt;code&gt;phpdebug&lt;/code&gt; 就行&lt;br&gt;需要取消的话 &lt;code&gt;phpdebugoff&lt;/code&gt; 就可以了&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;参考自：&lt;br&gt;&lt;a href=&quot;http://stackoverflow.com/questions/16518262/xdebug-how-to-debug-remote-console-application&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;xdebug-how-to-debug-remote-console-application&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.adayinthelifeof.nl/2012/12/20/debugging-remote-cli-with-phpstorm/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;debugging-remote-cli-with-phpstorm&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      基于phpstorm和vagrant环境的xdebug远程调试
    
    </summary>
    
      <category term="php" scheme="http://blog.newbmiao.com/categories/php/"/>
    
      <category term="tool" scheme="http://blog.newbmiao.com/categories/php/tool/"/>
    
    
      <category term="php" scheme="http://blog.newbmiao.com/tags/php/"/>
    
      <category term="xdebug" scheme="http://blog.newbmiao.com/tags/xdebug/"/>
    
  </entry>
  
  <entry>
    <title>让影梭和搬瓦工帮你科学上网</title>
    <link href="http://blog.newbmiao.com/2015/11/28/shadowsocks-polipo-vps.html"/>
    <id>http://blog.newbmiao.com/2015/11/28/shadowsocks-polipo-vps.html</id>
    <published>2015-11-28T14:11:31.000Z</published>
    <updated>2016-09-18T05:21:25.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;环境：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;server:shadowsocks(Linux)&lt;/li&gt;
&lt;li&gt;client:shadowsocks(Mac) , polipo&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;硬广：&lt;a href=&quot;https://bandwagonhost.com/aff.php?aff=5640&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;推荐VPS“搬瓦工”&lt;/a&gt;&lt;br&gt;理由有3：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;shadowsocks server： 一键安装（后续可自定义配置）&lt;/li&gt;
&lt;li&gt;性价比高：目前比较便宜的是 &lt;strong&gt;$19.99&lt;/strong&gt; 一年,256MB内存的VPS，而且可以用 &lt;strong&gt;支付宝&lt;/strong&gt; 支付&lt;/li&gt;
&lt;li&gt;操作不能在简单了！&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Shadowsocks具体干啥的，都懂得，介绍详见&lt;a href=&quot;https://wiki.archlinux.org/index.php/Shadowsocks&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Shadowsocks&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;准备工作：&lt;br&gt;去&lt;a href=&quot;https://bandwagonhost.com/aff.php?aff=5640&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;VPS“搬瓦工”&lt;/a&gt;买一个合适的VPS，然后用支付宝支付！&lt;/p&gt;
&lt;p&gt;接下来走安装流程，需要linux一些基础(server_ip和port,password请自行替换自己的)&lt;br&gt;利用ssh登陆VPS&lt;br&gt;&lt;figure class=&quot;highlight nginx&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;ssh&lt;/span&gt; root&lt;span class=&quot;variable&quot;&gt;@your_ip&lt;/span&gt; -p your_port&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#替换你的ip和端口（系统会邮件发给你）&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#输入你的密码&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;server&quot;&gt;&lt;a href=&quot;#server&quot; class=&quot;headerlink&quot; title=&quot;server&quot;&gt;&lt;/a&gt;server&lt;/h1&gt;&lt;h2 id=&quot;shadowsocks&quot;&gt;&lt;a href=&quot;#shadowsocks&quot; class=&quot;headerlink&quot; title=&quot;shadowsocks&quot;&gt;&lt;/a&gt;shadowsocks&lt;/h2&gt;&lt;p&gt;不推荐自己安装，依赖解决太麻烦：&lt;br&gt;&lt;del&gt;&lt;a href=&quot;https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-libev.sh&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;centos6一键安装脚本&lt;/a&gt;&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;利用官方一键安装：&lt;br&gt;KiwiVM （进入管理平台）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install new OS 》 选择Centos 6 x86 minimal 或者 Centos 6 x86_64 minimal安装即可，别作死安装centos7啊&lt;/li&gt;
&lt;li&gt;Shadowsocks Server 》安装Shadowsocks 》默认生成的已经可以用了，但是我们要自己可配端口和密码&lt;/li&gt;
&lt;li&gt;自定义配置&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;vi &lt;span class=&quot;meta-keyword&quot;&gt;/etc/&lt;/span&gt;shadowsocks.&lt;span class=&quot;class&quot;&gt;json&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;server&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;0.0.0.0&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;local_port&quot;&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1080&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;port_password&quot;&lt;/span&gt;:&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&quot;port1&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;password1&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&quot;port2&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;password2&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;timeout&quot;&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;//超时时间&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;aes-256-cfb&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;fast_open&quot;&lt;/span&gt;:false, &lt;span class=&quot;comment&quot;&gt;//如果你的服务器 Linux 内核在3.7+，可以开启 fast_open 以降低延迟&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;workers&quot;&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;//workers数量&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#结束掉系统安装的shadowsocks server&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;killall ssserver&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#启用自己配置的shadowsocks server&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta-keyword&quot;&gt;/usr/&lt;/span&gt;bin/ssserver -c  &lt;span class=&quot;meta-keyword&quot;&gt;/etc/&lt;/span&gt;shadowsocks.json --user nobody -d start&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;client&quot;&gt;&lt;a href=&quot;#client&quot; class=&quot;headerlink&quot; title=&quot;client&quot;&gt;&lt;/a&gt;client&lt;/h1&gt;&lt;h2 id=&quot;Mac-shadowsocks&quot;&gt;&lt;a href=&quot;#Mac-shadowsocks&quot; class=&quot;headerlink&quot; title=&quot;Mac-shadowsocks&quot;&gt;&lt;/a&gt;Mac-shadowsocks&lt;/h2&gt;&lt;figure class=&quot;highlight stata&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;brew install python3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;pip3 install shadowsocks&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;brew install openssl swig libevent&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;pip3 install m2crypto gevent&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi /usr/&lt;span class=&quot;keyword&quot;&gt;local&lt;/span&gt;/etc/shadowsocks-libev.json&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;server&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;my_server_ip&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;server_port&quot;&lt;/span&gt;: your_port,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;local_address&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;local_port&quot;&lt;/span&gt;:1080,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;password&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;*****&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;timeout&quot;&lt;/span&gt;: 60,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;aes-256-cfb&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 启动&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo touch /&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;/&lt;span class=&quot;keyword&quot;&gt;run&lt;/span&gt;/sslocal.pid /&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;/&lt;span class=&quot;keyword&quot;&gt;log&lt;/span&gt;/sslocal.&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo sslocal -c /usr/&lt;span class=&quot;keyword&quot;&gt;local&lt;/span&gt;/etc/shadowsocks-libev.json --user root --pid-&lt;span class=&quot;keyword&quot;&gt;file&lt;/span&gt; /&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;/&lt;span class=&quot;keyword&quot;&gt;run&lt;/span&gt;/sslocal.pid --&lt;span class=&quot;keyword&quot;&gt;log&lt;/span&gt;-&lt;span class=&quot;keyword&quot;&gt;file&lt;/span&gt; /&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;/&lt;span class=&quot;keyword&quot;&gt;log&lt;/span&gt;/sslocal.&lt;span class=&quot;keyword&quot;&gt;log&lt;/span&gt; -&lt;span class=&quot;keyword&quot;&gt;d&lt;/span&gt; start&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;polipo&quot;&gt;&lt;a href=&quot;#polipo&quot; class=&quot;headerlink&quot; title=&quot;polipo&quot;&gt;&lt;/a&gt;polipo&lt;/h2&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;brew &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; polipo&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 设置开机启动，并添加shadowsocks转换&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vim /usr/&lt;span class=&quot;keyword&quot;&gt;local&lt;/span&gt;/opt/polipo/homebrew.mxcl.polipo.plist&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-----------------------------------&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;lt;?&lt;span class=&quot;keyword&quot;&gt;xml&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;version&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;1.0&quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;encoding&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;lt;!DOCTYPE plist &lt;span class=&quot;keyword&quot;&gt;PUBLIC&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;-//Apple//DTD PLIST 1.0//EN&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;lt;plist &lt;span class=&quot;keyword&quot;&gt;version&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;lt;dict&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;Label&amp;lt;/&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;&amp;gt;homebrew.mxcl.polipo&amp;lt;/&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;RunAtLoad&amp;lt;/&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;/&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;KeepAlive&amp;lt;/&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;/&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;ProgramArguments&amp;lt;/&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;&lt;span class=&quot;built_in&quot;&gt;array&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      &amp;lt;&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;&amp;gt;/usr/&lt;span class=&quot;keyword&quot;&gt;local&lt;/span&gt;/opt/polipo/&lt;span class=&quot;keyword&quot;&gt;bin&lt;/span&gt;/polipo&amp;lt;/&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      &amp;lt;&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;&amp;gt;socksParentProxy=&lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.1&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1080&lt;/span&gt;&amp;lt;/&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;/&lt;span class=&quot;built_in&quot;&gt;array&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;!&lt;span class=&quot;comment&quot;&gt;-- Set `ulimit -n 20480`. The default OS X limit is 256, that&#39;s&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;         &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; enough &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; Polipo (displays &lt;span class=&quot;string&quot;&gt;&#39;too many files open&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;errors&lt;/span&gt;).&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;         It seems &lt;span class=&quot;keyword&quot;&gt;like&lt;/span&gt; you have &lt;span class=&quot;keyword&quot;&gt;no&lt;/span&gt; reason &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;lower&lt;/span&gt; this &lt;span class=&quot;keyword&quot;&gt;limit&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;         (&lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; unlikely will want &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;raise&lt;/span&gt; it). &lt;span class=&quot;comment&quot;&gt;--&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;SoftResourceLimits&amp;lt;/&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;dict&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      &amp;lt;&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;NumberOfFiles&amp;lt;/&lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      &amp;lt;&lt;span class=&quot;built_in&quot;&gt;integer&lt;/span&gt;&amp;gt;&lt;span class=&quot;number&quot;&gt;20480&lt;/span&gt;&amp;lt;/&lt;span class=&quot;built_in&quot;&gt;integer&lt;/span&gt;&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;lt;/dict&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;lt;/dict&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;lt;/plist&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-----------------------------------&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ln&lt;/span&gt; -sfv /usr/&lt;span class=&quot;keyword&quot;&gt;local&lt;/span&gt;/opt/polipo/homebrew.mxcl.polipo.plist ~/&lt;span class=&quot;keyword&quot;&gt;Library&lt;/span&gt;/LaunchAgents/homebrew.mxcl.polipo.plist&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;launchctl &lt;span class=&quot;keyword&quot;&gt;load&lt;/span&gt; ~/&lt;span class=&quot;keyword&quot;&gt;Library&lt;/span&gt;/LaunchAgents/homebrew.mxcl.polipo.plist&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;#这样开机回自动运行 :polipo socksParentProxy=&lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.1&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1080&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;** 命令行执行番羽墙加上下边两句 **&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;https_proxy=&lt;span class=&quot;keyword&quot;&gt;http&lt;/span&gt;://&lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.1&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;8123&lt;/span&gt; http_proxy=&lt;span class=&quot;keyword&quot;&gt;http&lt;/span&gt;://&lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.1&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;8123&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;** 建议设置&lt;span class=&quot;keyword&quot;&gt;alias&lt;/span&gt; **&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;alias&lt;/span&gt; fq=&lt;span class=&quot;string&quot;&gt;&quot;https_proxy=http://127.0.0.1:8123 http_proxy=http://127.0.0.1:8123&quot;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Android-shadowsocks&quot;&gt;&lt;a href=&quot;#Android-shadowsocks&quot; class=&quot;headerlink&quot; title=&quot;Android shadowsocks&quot;&gt;&lt;/a&gt;Android shadowsocks&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;温馨提示：不用ROOT！！！&lt;br&gt;&lt;a href=&quot;https://github.com/shadowsocks/shadowsocks-android/releases&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;shadowsocks-android(目前最新V3.1.3)&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;IOS&quot;&gt;&lt;a href=&quot;#IOS&quot; class=&quot;headerlink&quot; title=&quot;IOS&quot;&gt;&lt;/a&gt;IOS&lt;/h2&gt;&lt;p&gt;没有找到能用的IOS版本，知道的告我下！&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;到这里祝贺你科学上网了，google吧！&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      影梭，番羽墙，VPS，搬瓦工
    
    </summary>
    
      <category term="mac" scheme="http://blog.newbmiao.com/categories/mac/"/>
    
      <category term="shadowsocks" scheme="http://blog.newbmiao.com/categories/mac/shadowsocks/"/>
    
    
      <category term="mac" scheme="http://blog.newbmiao.com/tags/mac/"/>
    
      <category term="shadowsocks" scheme="http://blog.newbmiao.com/tags/shadowsocks/"/>
    
  </entry>
  
  <entry>
    <title>如何更新别人apple-id购买的应用</title>
    <link href="http://blog.newbmiao.com/2015/11/20/how-to-update-apps-apple-id.html"/>
    <id>http://blog.newbmiao.com/2015/11/20/how-to-update-apps-apple-id.html</id>
    <published>2015-11-20T09:30:11.000Z</published>
    <updated>2016-07-07T13:09:20.000Z</updated>
    
    <content type="html">&lt;p&gt;Mac的应用比如Xcode太大，一般不会自己下，别人airdrop给你，方便吧！&lt;br&gt;可是，升级时你就发现没有传给那个人的apple id密码你都没法升级了，而为了安全，除了appstore你别无选择&lt;/p&gt;
&lt;p&gt;不过方法还是有的，为了自己不用蛋疼，记录在这&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;清除apple-id信息&quot;&gt;&lt;a href=&quot;#清除apple-id信息&quot; class=&quot;headerlink&quot; title=&quot;清除apple id信息&quot;&gt;&lt;/a&gt;清除apple id信息&lt;/h2&gt;&lt;p&gt;右键Xcode.app &amp;gt;&amp;gt; 显示包内容 &amp;gt;&amp;gt; 找到_MASReceipt &amp;gt;&amp;gt; 删除recept&lt;/p&gt;
&lt;h2 id=&quot;更新文件缓存&quot;&gt;&lt;a href=&quot;#更新文件缓存&quot; class=&quot;headerlink&quot; title=&quot;更新文件缓存&quot;&gt;&lt;/a&gt;更新文件缓存&lt;/h2&gt;&lt;p&gt;第一步,&lt;br&gt;下载 &lt;a href=&quot;https://www.macupdate.com/app/mac/11582/onyx&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Download OnyX for Mac&lt;/a&gt;&lt;br&gt;第二步,&lt;br&gt;打开应用(需要管理员权限),&lt;br&gt;选择  维护 -&amp;gt; 重建 ,&lt;br&gt;把 “LaunchServices”, “dyld 的共享内存”,  “Spotlight索引” 选中,&lt;br&gt;最后点击 “执行”.&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/ixxonline/p/4087582.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;使用新的AppleID更新Xcode&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.zhihu.com/question/21448755&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;如何删除别人 apple id 购买的应用, 改用自己的 apple id 安装?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      如何更新别人apple-id购买的应用
    
    </summary>
    
      <category term="mac" scheme="http://blog.newbmiao.com/categories/mac/"/>
    
    
      <category term="software" scheme="http://blog.newbmiao.com/tags/software/"/>
    
  </entry>
  
  <entry>
    <title>jQuery应用杂记</title>
    <link href="http://blog.newbmiao.com/2015/10/25/jQuery-code-record.html"/>
    <id>http://blog.newbmiao.com/2015/10/25/jQuery-code-record.html</id>
    <published>2015-10-25T14:15:38.000Z</published>
    <updated>2017-01-19T08:13:09.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;strong&gt; 工作中常用的一些代码片段 &lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;全选&quot;&gt;&lt;a href=&quot;#全选&quot; class=&quot;headerlink&quot; title=&quot;全选&quot;&gt;&lt;/a&gt;全选&lt;/h2&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;$(&lt;span class=&quot;string&quot;&gt;&quot;#ckAll&quot;&lt;/span&gt;).click(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $(&lt;span class=&quot;string&quot;&gt;&quot;input[name=&#39;sub&#39;]&quot;&lt;/span&gt;).prop(&lt;span class=&quot;string&quot;&gt;&quot;checked&quot;&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.checked);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;//全部checkbox选中后 全选框也选中&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  $(&lt;span class=&quot;string&quot;&gt;&quot;input[name=&#39;sub&#39;]&quot;&lt;/span&gt;).click(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; $subs = $(&lt;span class=&quot;string&quot;&gt;&quot;input[name=&#39;sub&#39;]&quot;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    $(&lt;span class=&quot;string&quot;&gt;&quot;#ckAll&quot;&lt;/span&gt;).prop(&lt;span class=&quot;string&quot;&gt;&quot;checked&quot;&lt;/span&gt; , $subs.length == $subs.filter(&lt;span class=&quot;string&quot;&gt;&quot;:checked&quot;&lt;/span&gt;).length ? &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; :&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;获取选择内容&quot;&gt;&lt;a href=&quot;#获取选择内容&quot; class=&quot;headerlink&quot; title=&quot;获取选择内容&quot;&gt;&lt;/a&gt;获取选择内容&lt;/h2&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; uids = $(&lt;span class=&quot;string&quot;&gt;&#39;[name=subCk]:checked&#39;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          .map(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).data(&lt;span class=&quot;string&quot;&gt;&#39;id&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          &amp;#125;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          .get()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          .join();&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;全选和其他选项不能同时选中&quot;&gt;&lt;a href=&quot;#全选和其他选项不能同时选中&quot; class=&quot;headerlink&quot; title=&quot;全选和其他选项不能同时选中&quot;&gt;&lt;/a&gt;全选和其他选项不能同时选中&lt;/h2&gt;&lt;figure class=&quot;highlight typescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	 *@ckName checkbox-name&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	 *@i 对应index&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	*/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;checkToggle&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;ckName,i&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;.length==&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        i=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	    $(&lt;span class=&quot;string&quot;&gt;&quot;[name=&#39;&quot;&lt;/span&gt;+ckName+&lt;span class=&quot;string&quot;&gt;&quot;&#39;]:eq(&quot;&lt;/span&gt;+i+&lt;span class=&quot;string&quot;&gt;&quot;)&quot;&lt;/span&gt;).change(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ($(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).prop(&lt;span class=&quot;string&quot;&gt;&#39;checked&#39;&lt;/span&gt;)) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	            $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).parent().nextAll().children().prop(&lt;span class=&quot;string&quot;&gt;&#39;checked&#39;&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	    &amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	    $(&lt;span class=&quot;string&quot;&gt;&quot;[name=&#39;&quot;&lt;/span&gt;+ckName+&lt;span class=&quot;string&quot;&gt;&quot;&#39;]&quot;&lt;/span&gt;).not(&lt;span class=&quot;string&quot;&gt;&quot;:eq(&quot;&lt;/span&gt;+i+&lt;span class=&quot;string&quot;&gt;&quot;)&quot;&lt;/span&gt;).change(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ($(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).prop(&lt;span class=&quot;string&quot;&gt;&#39;checked&#39;&lt;/span&gt;)) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	            $(&lt;span class=&quot;string&quot;&gt;&quot;[name=&#39;&quot;&lt;/span&gt;+ckName+&lt;span class=&quot;string&quot;&gt;&quot;&#39;]:eq(&quot;&lt;/span&gt;+i+&lt;span class=&quot;string&quot;&gt;&quot;)&quot;&lt;/span&gt;).prop(&lt;span class=&quot;string&quot;&gt;&#39;checked&#39;&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	    &amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;## 切换条数&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	 &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; pageData=&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	     limit:&amp;lt;?=$limit;?&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	 &amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	 $(&lt;span class=&quot;string&quot;&gt;&quot;[value=&quot;&lt;/span&gt;+pageData.limit+&lt;span class=&quot;string&quot;&gt;&quot;]:radio&quot;&lt;/span&gt;).prop(&lt;span class=&quot;string&quot;&gt;&#39;checked&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;true&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	    $(&lt;span class=&quot;string&quot;&gt;&#39;[name=limit]:radio&#39;&lt;/span&gt;).change(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; limit=$(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).val();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;parseInt&lt;/span&gt;(limit)&amp;lt;&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(location.search.indexOf(&lt;span class=&quot;string&quot;&gt;&#39;limit=&#39;&lt;/span&gt;)!==&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;)&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	            location.search=location.search.replace(&lt;span class=&quot;regexp&quot;&gt;/limit=(\d*)?/&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;limit=&#39;&lt;/span&gt;+limit);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	            &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log((location.search==&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)?&lt;span class=&quot;string&quot;&gt;&#39;limit=&#39;&lt;/span&gt;+limit:&lt;span class=&quot;string&quot;&gt;&#39;&amp;amp;limit=&#39;&lt;/span&gt;+limit);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	            location.search=(location.search==&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)?&lt;span class=&quot;string&quot;&gt;&#39;limit=&#39;&lt;/span&gt;+limit:location.search+&lt;span class=&quot;string&quot;&gt;&#39;&amp;amp;limit=&#39;&lt;/span&gt;+limit;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&amp;#125;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;重置表单&quot;&gt;&lt;a href=&quot;#重置表单&quot; class=&quot;headerlink&quot; title=&quot;重置表单&quot;&gt;&lt;/a&gt;重置表单&lt;/h2&gt;&lt;p&gt;jQuery中没有重置表单的方法,如果需要，可以使用Dom的reset方法&lt;br&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;#myform&#39;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].reset()&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;select选择显示隐藏相关元素&quot;&gt;&lt;a href=&quot;#select选择显示隐藏相关元素&quot; class=&quot;headerlink&quot; title=&quot;select选择显示隐藏相关元素&quot;&gt;&lt;/a&gt;select选择显示隐藏相关元素&lt;/h2&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//选中与否select对应值，进行相应显示切换&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; selectMap = &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;#ddtype&#39;&lt;/span&gt;: &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;: &amp;#123;show: &lt;span class=&quot;string&quot;&gt;&#39;input[name=deadline]&#39;&lt;/span&gt;, hide: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;#aliasType&#39;&lt;/span&gt;: &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;: &amp;#123;show: &lt;span class=&quot;string&quot;&gt;&#39;.divAlias&#39;&lt;/span&gt;, hide: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;#type&#39;&lt;/span&gt;: &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;: &amp;#123;show: &lt;span class=&quot;string&quot;&gt;&#39;#sceneId&#39;&lt;/span&gt;, hide: &lt;span class=&quot;string&quot;&gt;&#39;.divExtra&#39;&lt;/span&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;selectShow.register(selectMap);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//函数&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; selectShow = &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    register: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;selectMap&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; me = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; select &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; selectMap) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; _select = selectMap[select];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;select, _select&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                $(select).change(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; option &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; _select) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ($(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).val() == option) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                            me.toggle(_select[option][&lt;span class=&quot;string&quot;&gt;&#39;show&#39;&lt;/span&gt;], _select[option][&lt;span class=&quot;string&quot;&gt;&#39;hide&#39;&lt;/span&gt;])&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                            me.toggle(_select[option][&lt;span class=&quot;string&quot;&gt;&#39;hide&#39;&lt;/span&gt;], _select[option][&lt;span class=&quot;string&quot;&gt;&#39;show&#39;&lt;/span&gt;])&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                &amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                $(select).change();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &amp;#125;)(select, _select);&lt;span class=&quot;comment&quot;&gt;//闭包注册&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    toggle: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;show, hide&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (show != &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            $(show).removeClass(&lt;span class=&quot;string&quot;&gt;&#39;hide&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (hide != &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            $(hide).addClass(&lt;span class=&quot;string&quot;&gt;&#39;hide&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;输入框字数检测&quot;&gt;&lt;a href=&quot;#输入框字数检测&quot; class=&quot;headerlink&quot; title=&quot;输入框字数检测&quot;&gt;&lt;/a&gt;输入框字数检测&lt;/h2&gt;&lt;figure class=&quot;highlight actionscript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&amp;lt;textarea id=&lt;span class=&quot;string&quot;&gt;&quot;msg&quot;&lt;/span&gt; name=&lt;span class=&quot;string&quot;&gt;&quot;msg&quot;&lt;/span&gt; cols=&lt;span class=&quot;string&quot;&gt;&quot;40&quot;&lt;/span&gt; rows=&lt;span class=&quot;string&quot;&gt;&quot;4&quot;&lt;/span&gt; data-max-len=&lt;span class=&quot;string&quot;&gt;&quot;50&quot;&lt;/span&gt; placeholder=&lt;span class=&quot;string&quot;&gt;&quot;内容字数不超过50个字&quot;&lt;/span&gt;&amp;gt;&amp;lt;/textarea&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;还可输入&amp;lt;span id=&lt;span class=&quot;string&quot;&gt;&quot;showLeft&quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;&amp;lt;/span&amp;gt;字&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//注册&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;$(document).on(&lt;span class=&quot;string&quot;&gt;&#39;keyup&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;#msg&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;		_maxlen.isMax(&lt;span class=&quot;string&quot;&gt;&#39;#msg&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;#showLeft&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;).focus(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;		_maxlen.disabledRightMouse();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;).blur(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;		_maxlen.enabledRightMouse();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; *监控输入字数&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * content:textarea[data-max-len] 输入框&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * container:span 显示剩余字数&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; * */&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; _maxlen = &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    isMax: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;(content, container)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; textarea = (&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; content == &lt;span class=&quot;string&quot;&gt;&#39;string&#39;&lt;/span&gt;) &amp;amp;&amp;amp; content.constructor == String ? $(content) : content;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        container = (&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; container == &lt;span class=&quot;string&quot;&gt;&#39;string&#39;&lt;/span&gt;) &amp;amp;&amp;amp; container.constructor == String ? $(container) : container;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; max_length = parseInt(textarea.data(&lt;span class=&quot;string&quot;&gt;&#39;max-len&#39;&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; _val = $.trim(textarea.val());&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; _leftLen = max_length;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (twttr.txt.getTweetLength(_val) &amp;gt; max_length) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            textarea.val(_val.substring(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, max_length));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            _leftLen = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            _leftLen = max_length - twttr.txt.getTweetLength(textarea.val());&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        container.text(_leftLen);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    disabledRightMouse: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        document.oncontextmenu = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    enabledRightMouse: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        document.oncontextmenu = &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      jQuery应用杂记
    
    </summary>
    
      <category term="web" scheme="http://blog.newbmiao.com/categories/web/"/>
    
      <category term="practice" scheme="http://blog.newbmiao.com/categories/web/practice/"/>
    
    
      <category term="js" scheme="http://blog.newbmiao.com/tags/js/"/>
    
      <category term="jquery" scheme="http://blog.newbmiao.com/tags/jquery/"/>
    
  </entry>
  
  <entry>
    <title>php信号处理</title>
    <link href="http://blog.newbmiao.com/2015/10/25/how-to-use-php-signal.html"/>
    <id>http://blog.newbmiao.com/2015/10/25/how-to-use-php-signal.html</id>
    <published>2015-10-25T14:10:33.000Z</published>
    <updated>2016-07-07T13:09:22.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;pcntl&quot;&gt;&lt;a href=&quot;#pcntl&quot; class=&quot;headerlink&quot; title=&quot;pcntl&quot;&gt;&lt;/a&gt;pcntl&lt;/h1&gt;&lt;h2 id=&quot;pcntl-signal&quot;&gt;&lt;a href=&quot;#pcntl-signal&quot; class=&quot;headerlink&quot; title=&quot;pcntl_signal&quot;&gt;&lt;/a&gt;pcntl_signal&lt;/h2&gt;&lt;p&gt;信号注册函数&lt;/p&gt;
&lt;h2 id=&quot;pcntl-alarm&quot;&gt;&lt;a href=&quot;#pcntl-alarm&quot; class=&quot;headerlink&quot; title=&quot;pcntl_alarm&quot;&gt;&lt;/a&gt;pcntl_alarm&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;指定秒数中断程序执行任务。&lt;/li&gt;
&lt;li&gt;每次执行只会有一个定时器生效，若之前计时器还没结束就定义新定时器，会替代之前定时器并返回之前定时器结束前秒数，若之前计时器已完成返回0&lt;/li&gt;
&lt;li&gt;参数设为0，会清空当前所有定时器，并不发起调用&lt;/li&gt;
&lt;li&gt;定时器会中断系统，即便是sleep执行中&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
declare(ticks = 1);

function signal_handler($signal) {
    print &amp;quot;Caught SIGALRM\n&amp;quot;;
    echo pcntl_alarm(3).PHP_EOL;//再次调用
}

pcntl_signal(SIGALRM, &amp;quot;signal_handler&amp;quot;, true);
echo pcntl_alarm(5).PHP_EOL;//只会调用一次

echo pcntl_alarm(3).PHP_EOL;//提示5，因为上一个计时器完成还剩5s

while(1) {
    //
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;pcntl-fork&quot;&gt;&lt;a href=&quot;#pcntl-fork&quot; class=&quot;headerlink&quot; title=&quot;pcntl_fork&quot;&gt;&lt;/a&gt;pcntl_fork&lt;/h2&gt;&lt;p&gt;创建子进程&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;unix创建进程效率要比线程高，但需考虑进程数和内存等限制&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
$pid = pcntl_fork();

switch($pid) {
    case -1:
        print &amp;quot;Could not fork!\n&amp;quot;;
        exit;
    case 0://子进程
        print &amp;quot;In child!\n&amp;quot;;
        break;
    default://父进程，值代表子进程PID
        print &amp;quot;In parent!\n&amp;quot;;
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;pcntl-waitpid&quot;&gt;&lt;a href=&quot;#pcntl-waitpid&quot; class=&quot;headerlink&quot; title=&quot;pcntl_waitpid&quot;&gt;&lt;/a&gt;pcntl_waitpid&lt;/h2&gt;&lt;p&gt;等待或返回fork的子进程状态&lt;br&gt;挂起当前进程的执行直到参数pid指定的进程号的进程退出， 或接收到一个信号要求中断当前进程或调用一个信号处理函数。&lt;br&gt;如果pid指定的子进程在此函数调用时已经退出（俗称僵尸进程），此函数 将立刻返回。&lt;br&gt;&lt;strong&gt;pid可选值&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;小于-1     等待任意进程组ID等于参数pid给定值的绝对值的进程。&lt;/li&gt;
&lt;li&gt;-1     等待任意子进程;与pcntl_wait函数行为一致。&lt;/li&gt;
&lt;li&gt;0     等待任意与调用进程组ID相同的子进程。&lt;/li&gt;
&lt;li&gt;大于0     等待进程号等于参数pid值的子进程。 &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;options&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;WNOHANG     如果没有子进程退出立刻返回。&lt;/li&gt;
&lt;li&gt;WUNTRACED     子进程已经退出并且其状态未报告时返回。 &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://www.hackingwithphp.com/16/1/7/other-ways-to-evaluate-pcntl_waitpids-return-value&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;其他方式去计算本函数的返回值&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;pcntl-wexitstatus&quot;&gt;&lt;a href=&quot;#pcntl-wexitstatus&quot; class=&quot;headerlink&quot; title=&quot;pcntl_wexitstatus&quot;&gt;&lt;/a&gt;pcntl_wexitstatus&lt;/h2&gt;&lt;p&gt;检查状态代码是否代表一个正常的退出。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;进程共享内容&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
for ($i = 1; $i &amp;lt;= 5; ++$i) {
    $pid = pcntl_fork();

    if (!$pid) {
        sleep(1);
        print &amp;quot;In child $i\n&amp;quot;;
        exit($i);
    }
}
while (pcntl_waitpid(0, $status) != -1) {
    $status = pcntl_wexitstatus($status);
    echo &amp;quot;Child $status completed\n&amp;quot;;
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;SIGCHLD-父进程不阻塞&quot;&gt;&lt;a href=&quot;#SIGCHLD-父进程不阻塞&quot; class=&quot;headerlink&quot; title=&quot;SIGCHLD: 父进程不阻塞&quot;&gt;&lt;/a&gt;SIGCHLD: 父进程不阻塞&lt;/h2&gt;&lt;p&gt;SIGCHLD信号会在&lt;strong&gt;一个或多个&lt;/strong&gt;子进程结束时向父进程通知&lt;br&gt;此时再加上pcntl_waitpid loop来让父进程及时回收全部结束的子进程&lt;/p&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
declare(ticks = 1);

pcntl_signal(SIGCHLD, &amp;quot;signal_handler&amp;quot;);

function signal_handler($signal) {
    switch($signal) {
        case SIGCHLD:
            while (pcntl_waitpid(0, $status) != -1) {
                $status = pcntl_wexitstatus($status);
                echo &amp;quot;Child $status completed\n&amp;quot;;
            }

            exit;
    }
}

for ($i = 1; $i &amp;lt;= 5; ++$i) {
    $pid = pcntl_fork();

    if (!$pid) {
        sleep(3);
        print &amp;quot;In child $i\n&amp;quot;;
        exit($i);
    }
}

while(1) {
    //下面的代码会在父进程执行
    echo &amp;quot;parent processing here&amp;quot;.PHP_EOL;
    sleep(1);
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;pcntl-exec&quot;&gt;&lt;a href=&quot;#pcntl-exec&quot; class=&quot;headerlink&quot; title=&quot;pcntl_exec&quot;&gt;&lt;/a&gt;pcntl_exec&lt;/h2&gt;&lt;p&gt;调用程序执行，并取代自身&lt;/p&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
print &amp;quot;Before\n&amp;quot;;
pcntl_exec(&amp;quot;/usr/bin/uptime&amp;quot;);
//下边不会输出
print &amp;quot;After\n&amp;quot;; 
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      php信号处理
    
    </summary>
    
      <category term="php" scheme="http://blog.newbmiao.com/categories/php/"/>
    
      <category term="signal" scheme="http://blog.newbmiao.com/categories/php/signal/"/>
    
    
      <category term="php" scheme="http://blog.newbmiao.com/tags/php/"/>
    
      <category term="pcntl" scheme="http://blog.newbmiao.com/tags/pcntl/"/>
    
      <category term="signal" scheme="http://blog.newbmiao.com/tags/signal/"/>
    
  </entry>
  
  <entry>
    <title>gearman分布式任务服务器学习记录</title>
    <link href="http://blog.newbmiao.com/2015/10/16/gearman-beginer-guide.html"/>
    <id>http://blog.newbmiao.com/2015/10/16/gearman-beginer-guide.html</id>
    <published>2015-10-16T13:18:33.000Z</published>
    <updated>2016-07-07T13:45:11.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;以下是强大的gearman学习及安装记录，代码demo下边的来自网络的附录有很多可以参考。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Gearman 是一套用来把程式需求委派给机器，提供通用的程序框架来将任务分发在机器运算。&lt;br&gt;它同时具备并行工作的能力、负载均衡处理的能力，以及在不同程序语言之间沟通的能力。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安装&quot; class=&quot;headerlink&quot; title=&quot;安装&quot;&gt;&lt;/a&gt;安装&lt;/h2&gt;&lt;h3 id=&quot;gearmand&quot;&gt;&lt;a href=&quot;#gearmand&quot; class=&quot;headerlink&quot; title=&quot;gearmand&quot;&gt;&lt;/a&gt;gearmand&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://launchpad.net/gearmand&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;gearmand-job server&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;安装gearmand依赖的库&quot;&gt;&lt;a href=&quot;#安装gearmand依赖的库&quot; class=&quot;headerlink&quot; title=&quot;安装gearmand依赖的库&quot;&gt;&lt;/a&gt;安装gearmand依赖的库&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;yum install -y boost-devel gperf libevent-devel libuuid-devel
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&quot;安装gearmand服务&quot;&gt;&lt;a href=&quot;#安装gearmand服务&quot; class=&quot;headerlink&quot; title=&quot;安装gearmand服务&quot;&gt;&lt;/a&gt;安装gearmand服务&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;tar xzf gearmand-1.1.12.tar.gz
cd gearmand-1.1.12
./configure
make
make install
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;gearman&quot;&gt;&lt;a href=&quot;#gearman&quot; class=&quot;headerlink&quot; title=&quot;gearman&quot;&gt;&lt;/a&gt;gearman&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://pecl.php.net/package/gearman&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;php扩展&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;安装php扩展&quot;&gt;&lt;a href=&quot;#安装php扩展&quot; class=&quot;headerlink&quot; title=&quot;安装php扩展&quot;&gt;&lt;/a&gt;安装php扩展&lt;/h4&gt;&lt;pre&gt;&lt;code&gt; tar xzf gearman-1.1.2.tgz
cd gearman-1.1.2
phpize
./configure
make
make install   

# 在php.ini中添加
extension=&amp;quot;gearman.so&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;gearman启动&quot;&gt;&lt;a href=&quot;#gearman启动&quot; class=&quot;headerlink&quot; title=&quot;gearman启动&quot;&gt;&lt;/a&gt;gearman启动&lt;/h3&gt;&lt;pre&gt;&lt;code&gt; 1) 创建日志gearmand.log
# touch /pathto/logs/gearmand.log

2）启动
# /usr/local/sbin/gearmand -d -u root -L 192.168.142.130 --log-file=/pathto/logs/gearmand.log

3）参数详解
-b，--backlog= 储备的监听连接数量
-d, --daemon 后台运行
-f, --file-descriptors= 文件描述符的数量
-h, --help 帮助
-j, --job-retries= 在ob server移除不可用job之前运行的次数，防止不断运行导致其他可用worker崩溃。默认没有限制
-l, -log-file= 日志文件存放位置(默认记录最简单日志)
-L, --listen= 监听的IP，默认全部接受
-p, --port= 指定监听端口
-P, --pid-file= 指定进程ID写入位置
-r, --protocol= 加载协议模块
-q, --queue-type= 指定持久化队列
-t, --threads= 使用的I/9线程数量。默认为0
-u, --user= 启动后，切换到指定用户
-v, --verbose 增加一级详细程度
-V, --version 显示版本信息
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt; issue &lt;/strong&gt;: /usr/local/sbin/gearmand: error while loading shared libraries: libmysqlclient.so.18: cannot open shared object file: No such file or directory&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;解决方案：将对应lib链接到/usr/lib&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ln -s /home/vagrant/online/mysql5.6/lib/libmysqlclient.so.18  /usr/lib
ldconfig -v
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;gearman部署&quot;&gt;&lt;a href=&quot;#gearman部署&quot; class=&quot;headerlink&quot; title=&quot;gearman部署&quot;&gt;&lt;/a&gt;gearman部署&lt;/h3&gt;&lt;h4 id=&quot;启动gearmand&quot;&gt;&lt;a href=&quot;#启动gearmand&quot; class=&quot;headerlink&quot; title=&quot;启动gearmand&quot;&gt;&lt;/a&gt;启动gearmand&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;启动&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/usr/local/sbin/gearmand -d -u root -L 0.0.0.0 --log-file=/pathto/logs/gearmand.log
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;对应配置修改 common.conf &amp;gt; gearman配置&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;启动worker&quot;&gt;&lt;a href=&quot;#启动worker&quot; class=&quot;headerlink&quot; title=&quot;启动worker&quot;&gt;&lt;/a&gt;启动worker&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;后台运行&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nohup php scripts/gearman_job/job.php &amp;gt;/log/gearman.log &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;supervisor守护worker进程（推荐）&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;yum install supervisor
service supervisor start
service supervisor stop
#创建配置文件
/etc/supervisor/conf.d/gearmanwoker.conf:

[program:gearmanwoker]
command=php scripts/gearman_job/job.php
numprocs=12
directory=/dir_path/to/woker/
autostart=true
autorestart=true
stdout_logfile=/path/to/project/log/gearmanwoker.log
stdout_logfile_maxbytes=1MB
stderr_logfile=/path/to/project/log/gearmanwoker.log
stderr_logfile_maxbytes=1MB
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;参见&lt;a href=&quot;http://www.daredevel.com/php-jobs-with-gearman-and-supervisor/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;php-jobs-with-gearman-and-supervisor&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;update 2015 12-13&lt;/p&gt;
&lt;h2 id=&quot;worker管理：gearman-manager-（pecl-manger）&quot;&gt;&lt;a href=&quot;#worker管理：gearman-manager-（pecl-manger）&quot; class=&quot;headerlink&quot; title=&quot;worker管理：gearman manager （pecl_manger）&quot;&gt;&lt;/a&gt;worker管理：gearman manager （pecl_manger）&lt;/h2&gt;&lt;h3 id=&quot;gearmanManager&quot;&gt;&lt;a href=&quot;#gearmanManager&quot; class=&quot;headerlink&quot; title=&quot;gearmanManager&quot;&gt;&lt;/a&gt;gearmanManager&lt;/h3&gt;&lt;p&gt;&lt;strong&gt; 配置中需指定host，pid及log等 &lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&quot;启动manager-daemon&quot;&gt;&lt;a href=&quot;#启动manager-daemon&quot; class=&quot;headerlink&quot; title=&quot;启动manager daemon&quot;&gt;&lt;/a&gt;启动manager daemon&lt;/h4&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;scripts/gearmanManager/bin/pecl_manager&lt;span class=&quot;selector-class&quot;&gt;.php&lt;/span&gt; -c scripts/gearmanManager/etc/config&lt;span class=&quot;selector-class&quot;&gt;.ini&lt;/span&gt;  -d -vvv&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;关闭&quot;&gt;&lt;a href=&quot;#关闭&quot; class=&quot;headerlink&quot; title=&quot;关闭&quot;&gt;&lt;/a&gt;关闭&lt;/h4&gt;&lt;figure class=&quot;highlight perl&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#SIGINT&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;kill&lt;/span&gt; -&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;`cat gearman-manager.pid`&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;重启child（worker）&quot;&gt;&lt;a href=&quot;#重启child（worker）&quot; class=&quot;headerlink&quot; title=&quot;重启child（worker）&quot;&gt;&lt;/a&gt;重启child（worker）&lt;/h4&gt;&lt;figure class=&quot;highlight perl&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# SIGHUP&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;kill&lt;/span&gt; -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;`cat gearman-manager.pid`&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;gearmand-queue-持久化（针对background任务）&quot;&gt;&lt;a href=&quot;#gearmand-queue-持久化（针对background任务）&quot; class=&quot;headerlink&quot; title=&quot;gearmand queue 持久化（针对background任务）&quot;&gt;&lt;/a&gt;gearmand queue 持久化（针对background任务）&lt;/h2&gt;&lt;p&gt;对于大量访问压力及server宕机都有好处&lt;/p&gt;
&lt;figure class=&quot;highlight haml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;sudo /usr/local/sbin/gearmand -d -u root -L 0.0.0.0 --log-file=/pathto/gearmand.log   --queue-type=MySQL \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          -&lt;span class=&quot;ruby&quot;&gt;-mysql-host=localhost \&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          -&lt;span class=&quot;ruby&quot;&gt;-mysql-port=&lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt; \&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          -&lt;span class=&quot;ruby&quot;&gt;-mysql-user=root \&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          -&lt;span class=&quot;ruby&quot;&gt;-mysql-password=YOUR_PASSWORD \&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          -&lt;span class=&quot;ruby&quot;&gt;-mysql-db=qsc \&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;          -&lt;span class=&quot;ruby&quot;&gt;-mysql-table=gearman_queue&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;参考&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;phpboy&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.phpboy.net/2014-05/40-gearman-instruction.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Gearman调研/测试/原理分析&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;gearman&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://gearman.info/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;gearman.info&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://gearman.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;gearman.org&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://groups.google.com/group/gearman&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;gearman google group&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      gearman分布式任务服务器学习记录
    
    </summary>
    
      <category term="gearman" scheme="http://blog.newbmiao.com/categories/gearman/"/>
    
    
      <category term="gearman" scheme="http://blog.newbmiao.com/tags/gearman/"/>
    
  </entry>
  
  <entry>
    <title>iframe实现的无刷tab页</title>
    <link href="http://blog.newbmiao.com/2015/10/14/jquery-tabs-with-iframe.html"/>
    <id>http://blog.newbmiao.com/2015/10/14/jquery-tabs-with-iframe.html</id>
    <published>2015-10-14T01:29:19.000Z</published>
    <updated>2016-07-07T13:09:22.000Z</updated>
    
    <content type="html">&lt;p&gt;为了实现tab页无刷，又不想全部用ajax动态生成，同时需要在tab页内有相关操作，简单的话就是用iframe了&lt;/p&gt;
&lt;p&gt;先来看个demo: &lt;a href=&quot;http://blog.newbmiao.com/demo/iframe-tabs.html&quot;&gt;iframe-tabs&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;参考自&lt;a href=&quot;http://deano.me/2011/08/jquery-tabs-iframes/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;jquery-tabs-iframes&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这个demo实现了基本的需求，使用中发现还有两点问题&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;iframe 高度自适应&lt;/li&gt;
&lt;li&gt;如果在iframe页内 &lt;code&gt;history.back(-1)&lt;/code&gt; 历史返回时要记录之前选择的tab页&lt;/li&gt;
&lt;li&gt;如果tab页要求实时性，还需要每次点击都请求页面，同时也可以只加载一个iframe并替换其src来复用，而不必每个tab都加载一个iframe&lt;/li&gt;
&lt;/ol&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;对于问题1：&quot;&gt;&lt;a href=&quot;#对于问题1：&quot; class=&quot;headerlink&quot; title=&quot;对于问题1：&quot;&gt;&lt;/a&gt;对于问题1：&lt;/h3&gt;&lt;p&gt;tabs的高度有统一设置，原demo的高度设置就可以使用，如果是单独针对外部iframe可使用&lt;/p&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
    function iFrameHeight(id) {
        var ifm= document.getElementById(id);
        var subWeb = document.frames ? document.frames[id].document : ifm.contentDocument;
        if(ifm != null &amp;amp;&amp;amp; subWeb != null) {
            ifm.height = subWeb.body.scrollHeight;
            ifm.width = subWeb.body.scrollWidth;
            //动态设置高度后。避免滚动条滑到最下，要设置滑到顶端
            document.body.scrollTop = document.documentElement.scrollTop = 0;
        }
    }
&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;对于问题2：&quot;&gt;&lt;a href=&quot;#对于问题2：&quot; class=&quot;headerlink&quot; title=&quot;对于问题2：&quot;&gt;&lt;/a&gt;对于问题2：&lt;/h3&gt;&lt;p&gt;使用localStorage或者sessionStorage可以记录tab选中状态，如果页面有其他唯一性标志，也可以和tab状态一同记录，便于判断是否要还原tab选中状态&lt;/p&gt;
&lt;p&gt;下边两个封装好的store.js都便于多平台兼容&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/nbubna/store&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nbubna/store&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/marcuswestin/store.js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;marcuswestin/store.js&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;//返回时，将记录的tab状态还原
var tabIndex =  0;
//#subContainer为iframe，pageData.unique为页面唯一标识
if ($(&amp;quot;#subContainer&amp;quot;).length == 0 &amp;amp;&amp;amp; store.get(&amp;apos;tab&amp;apos;)) {
    tabIndex=store.get(&amp;apos;tab&amp;apos;) ;
    if(tabIndex.split(&amp;apos;-&amp;apos;)[0]==pageData.unique){
        tabIndex=tabIndex.split(&amp;apos;-&amp;apos;)[1];
    }
}
var $tabs = $(&amp;apos;#tabs&amp;apos;).tabs();
$(&amp;apos;#tabs&amp;apos;).tabs( &amp;quot;option&amp;quot;, &amp;quot;active&amp;quot;, tabIndex );

//在loadTabFrame()后
store.set(&amp;apos;tab&amp;apos;, pageData.unique+&amp;quot;-&amp;quot;+(parseInt(tab.split(&amp;apos;-&amp;apos;)[1])-1));
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;对于问题3：&quot;&gt;&lt;a href=&quot;#对于问题3：&quot; class=&quot;headerlink&quot; title=&quot;对于问题3：&quot;&gt;&lt;/a&gt;对于问题3：&lt;/h3&gt;&lt;p&gt;将loadTabFrame中添加&lt;/p&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;if ($(&amp;quot;#subContainer&amp;quot;).length != 0) {
    $(&amp;apos;#subContainer&amp;apos;).prop(&amp;apos;src&amp;apos;, url);
    $(&amp;apos;#aOpenOut&amp;apos;).prop(&amp;apos;href&amp;apos;, url);
    //detach来复用
    $(tab).append($(&amp;apos;.tabIframeWrapper&amp;apos;).detach());
    $(tab).find(&amp;quot;iframe&amp;quot;).height($(window).height() - 80);
    store.set(&amp;apos;tab&amp;apos;, pageData.unique+&amp;quot;-&amp;quot;+(parseInt(tab.split(&amp;apos;-&amp;apos;)[1])-1));
    return;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; 如此，完美解决无刷tab页需求。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      iframe实现的无刷tab页
    
    </summary>
    
      <category term="web" scheme="http://blog.newbmiao.com/categories/web/"/>
    
      <category term="practice" scheme="http://blog.newbmiao.com/categories/web/practice/"/>
    
    
      <category term="jquery" scheme="http://blog.newbmiao.com/tags/jquery/"/>
    
      <category term="iframe" scheme="http://blog.newbmiao.com/tags/iframe/"/>
    
  </entry>
  
  <entry>
    <title>中秋举牌</title>
    <link href="http://blog.newbmiao.com/2015/09/27/up-up-in-mid-autumn-day.html"/>
    <id>http://blog.newbmiao.com/2015/09/27/up-up-in-mid-autumn-day.html</id>
    <published>2015-09-27T03:07:08.000Z</published>
    <updated>2016-07-07T13:09:18.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;舉牌是一種支持的態度，是一種相信希望的精神，每隻可愛的小人都代表著支持你的人，鼓舞著你。舉牌世界沒有人是孤獨的，有時你需要獨自面對眼前的難關，舉牌小人會陪伴與鼓勵你，用舉牌挺你走向希望。我們相信有許多美好的事都等著我們高舉著，並將這樣的精神與鼓勵不斷地蔓延下去。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;img src=&quot;http://media.newbmiao.com/blog/zhongqiu2.jpg&quot; alt=&quot;码农们，中秋快乐！&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://media.newbmiao.com/blog/zhongqiu3.jpg&quot; alt=&quot;还有那句：Hello World&quot;&gt;&lt;/p&gt;
&lt;p&gt;DIY?&lt;br&gt;SEE HERE: &lt;a href=&quot;http://upuptoyou.com/#&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;upup-play&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      中秋举牌
    
    </summary>
    
      <category term="journal" scheme="http://blog.newbmiao.com/categories/journal/"/>
    
    
      <category term="journal" scheme="http://blog.newbmiao.com/tags/journal/"/>
    
  </entry>
  
  <entry>
    <title>php银行卡校验</title>
    <link href="http://blog.newbmiao.com/2015/09/25/use-luhm-to-validate-bank-card.html"/>
    <id>http://blog.newbmiao.com/2015/09/25/use-luhm-to-validate-bank-card.html</id>
    <published>2015-09-25T07:54:54.000Z</published>
    <updated>2016-07-07T13:09:22.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;前言&lt;/strong&gt;&lt;br&gt;银行金卡，维萨和万事达、银联品牌，如果是贷记卡或准贷记卡，一定为16位卡号。而借记卡可以16-19位不等。&lt;br&gt;美国运通卡则不论金卡或是白金卡、普通卡，都是15位卡号。&lt;br&gt;16-19 位卡号校验位采用 Luhm 校验方法计算&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h1 id=&quot;银行卡的校验方式&quot;&gt;&lt;a href=&quot;#银行卡的校验方式&quot; class=&quot;headerlink&quot; title=&quot;银行卡的校验方式&quot;&gt;&lt;/a&gt;银行卡的校验方式&lt;/h1&gt;&lt;h2 id=&quot;Luhm校验&quot;&gt;&lt;a href=&quot;#Luhm校验&quot; class=&quot;headerlink&quot; title=&quot;Luhm校验&quot;&gt;&lt;/a&gt;Luhm校验&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;将未带校验位的 15 位卡号从右依次编号 1 到 15，位于奇数位号上的数字乘以 2&lt;/li&gt;
&lt;li&gt;将奇位乘积的个十位全部相加，再加上所有偶数位上的数字&lt;/li&gt;
&lt;li&gt;将加法和加上校验位能被 10 整除。&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
/*
  16-19 位卡号校验位采用 Luhm 校验方法计算：
    1，将未带校验位的 15 位卡号从右依次编号 1 到 15，位于奇数位号上的数字乘以 2
    2，将奇位乘积的个十位全部相加，再加上所有偶数位上的数字
    3，将加法和加上校验位能被 10 整除。
*/
function luhm($s) {
    $n = 0;
    for ($i = strlen($s); $i &amp;gt;= 1; $i--) {
        $index=$i-1;
        //偶数位
        if ($i % 2==0) {
            $n += $s{$index};
        } else {//奇数位
            $t = $s{$index} * 2;
            if ($t &amp;gt; 9) {
                $t = (int)($t/10)+ $t%10;
            }
            $n += $t;
        }
    }
    return ($n % 10) == 0;
}

$r = luhm(&amp;apos;6225881414207430&amp;apos;);
var_dump($r);
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;准确率怎么样，附文一片&lt;br&gt;&lt;a href=&quot;http://xiangkg.blog.163.com/blog/static/56688504201269112417414/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;银行卡校验规则(Luhn算法)&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      php银行卡校验
    
    </summary>
    
      <category term="php" scheme="http://blog.newbmiao.com/categories/php/"/>
    
    
      <category term="php" scheme="http://blog.newbmiao.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>记一次mysql优化操作</title>
    <link href="http://blog.newbmiao.com/2015/09/25/remember-once-mysql-optimize-operations.html"/>
    <id>http://blog.newbmiao.com/2015/09/25/remember-once-mysql-optimize-operations.html</id>
    <published>2015-09-25T06:14:20.000Z</published>
    <updated>2016-07-07T13:09:20.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;这次操作，起因是需要获取用户来源及用户性别，而用户的性别信息在第三方授权的中有，存为JSON格式，&lt;br&gt;不想用php去解析获取，所以试试mysql操作&lt;br&gt;如果你有更好的解决方案，请留言告诉我！&lt;/p&gt;
&lt;h1 id=&quot;情景简化&quot;&gt;&lt;a href=&quot;#情景简化&quot; class=&quot;headerlink&quot; title=&quot;情景简化&quot;&gt;&lt;/a&gt;情景简化&lt;/h1&gt;&lt;h2 id=&quot;表结构&quot;&gt;&lt;a href=&quot;#表结构&quot; class=&quot;headerlink&quot; title=&quot;表结构&quot;&gt;&lt;/a&gt;表结构&lt;/h2&gt;&lt;p&gt;记录用户授权信息，有微博、QQ、微信，个人信息存为user_info&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;user_platform&lt;ul&gt;
&lt;li&gt;weibo_id,qq_id,weixin_id,user_info,uid,user_platform_id&lt;h2 id=&quot;性别格式&quot;&gt;&lt;a href=&quot;#性别格式&quot; class=&quot;headerlink&quot; title=&quot;性别格式&quot;&gt;&lt;/a&gt;性别格式&lt;/h2&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;微博 【gender】(‘m’ =&amp;gt;男,’f’ =&amp;gt; 女,’n’ =&amp;gt; 未知)&lt;/li&gt;
&lt;li&gt;QQ 【gender】 (‘男’ ,’女’ )&lt;/li&gt;
&lt;li&gt;微信 【sex】(1 =&amp;gt;男,2 =&amp;gt; 女)&lt;h2 id=&quot;附加条件&quot;&gt;&lt;a href=&quot;#附加条件&quot; class=&quot;headerlink&quot; title=&quot;附加条件&quot;&gt;&lt;/a&gt;附加条件&lt;/h2&gt;&lt;/li&gt;
&lt;li&gt;数据量近百万行，处理不能太耗时&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;hr&gt;
&lt;h1 id=&quot;用户来源&quot;&gt;&lt;a href=&quot;#用户来源&quot; class=&quot;headerlink&quot; title=&quot;用户来源&quot;&gt;&lt;/a&gt;用户来源&lt;/h1&gt;&lt;p&gt;先来个简单的，因为授权账户不是和用户一一对应，所以就是判断相关第三方id不为空则为对应用户来源，没有涉及绑定所以第三方信息实际唯一（表设计不是很合理，这个略过）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT IF((ISNULL(weixin_id) || weixin_id != &amp;apos;&amp;apos;, IF((ISNULL(weibo_id) || weibo_id != &amp;apos;&amp;apos;, IF((ISNULL(qq_id) || qq_id != &amp;apos;&amp;apos;, &amp;apos;手机&amp;apos;, &amp;apos;QQ&amp;apos;), &amp;apos;微博&amp;apos;), &amp;apos;微信&amp;apos;) AS user_source, uid
FROM user_platform
WHERE uid != 0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中 &lt;code&gt;ISNULL(weixin_id) || weixin_id != &amp;#39;&amp;#39;&lt;/code&gt; 用来判断null和空字符串两种情况 也可以用 &lt;code&gt;ISNULL(weixin_id) || LENGTH(TRIM(weixin_id)) &amp;lt; 1&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;性别获取&quot;&gt;&lt;a href=&quot;#性别获取&quot; class=&quot;headerlink&quot; title=&quot;性别获取&quot;&gt;&lt;/a&gt;性别获取&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;分两类（gender，sex）去截取性别，&lt;/li&gt;
&lt;li&gt;然后放到临时表中，处理为统一格式的sex（1=&amp;gt;男,2=&amp;gt;女,0=&amp;gt;未知）&lt;/li&gt;
&lt;li&gt;在用户表中加一列sex并利用临时表更新&lt;h2 id=&quot;字符替换判断&quot;&gt;&lt;a href=&quot;#字符替换判断&quot; class=&quot;headerlink&quot; title=&quot;字符替换判断&quot;&gt;&lt;/a&gt;字符替换判断&lt;/h2&gt;使用mysql函数&lt;/li&gt;
&lt;li&gt;locate&lt;/li&gt;
&lt;li&gt;mid&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以微信为例，判断是否包含性别&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT locate(&amp;apos;sex&amp;quot;:&amp;apos;, user_info, 50) AS is_sex
FROM user_platform
WHERE user_info != &amp;apos;&amp;apos;    
HAVING is_sex != 0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后截取性别，开始用&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT locate(&amp;apos;sex&amp;quot;:&amp;apos;, user_info, 50) AS is_sex, mid(user_info, locate(&amp;apos;sex&amp;quot;:&amp;apos;, user_info, 50) + 5, 1) AS sex
FROM user_platform
WHERE user_info != &amp;apos;&amp;apos;
HAVING is_sex != 0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;发现特变慢，而且locate一样的判断执行两次，不如换做一次&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT mid(user_info, is_sex + 5, 1) AS sex, uid
FROM user_platform p, (SELECT locate(&amp;apos;sex&amp;quot;:&amp;apos;, user_info, 50) AS is_sex, user_platform_id
    FROM user_platform
    WHERE user_info != &amp;apos;&amp;apos;
        AND uid != 0
    HAVING is_sex != 0
    ) t
WHERE t.user_platform_id = p.user_platform_id
GROUP BY uid
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;既然判断index，那如果先知道从哪开始判断&lt;/strong&gt;,那就先获取最小位置，再利用locate第三个参数pos加快查找&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT MIN(is_sex)
FROM (SELECT locate(&amp;apos;sex&amp;quot;:&amp;apos;, user_info) AS is_sex
    FROM user_platform
    WHERE user_info != &amp;apos;&amp;apos;

    HAVING is_sex != 0
    ) t
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;获取到最小位置为：57，那就 locate(‘sex”:’, user_info,55) ,其实可以用57，保险起见小点啦&lt;/p&gt;
&lt;p&gt;效率提升,主要时间上 （本地PC测试）： 10.17 sec 》》》7.36 sec&lt;/p&gt;
&lt;p&gt;然后插入到临时表，mysql不能直接select into，所以先创建表载insert into&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CREATE TABLE user_sex (
    uid int(11) NOT NULL,
    sex char(1) NOT NULL,
    PRIMARY KEY (uid)
)ENGINE = InnoDB DEFAULT CHARSET = `utf8`;

INSERT INTO user_sex
    (uid, sex)
SELECT uid, sex
FROM (SELECT mid(user_info, is_sex + 5, 1) AS sex, uid
    FROM user_platform p, (SELECT locate(&amp;apos;sex&amp;quot;:&amp;apos;, user_info, 55) AS is_sex, user_platform_id
        FROM user_platform
        WHERE user_info != &amp;apos;&amp;apos;
            AND uid != 0
        HAVING is_sex != 0
        ) t
    WHERE t.user_platform_id = p.user_platform_id GROUP BY uid
    ) tmp
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;微博和QQ的相同处理，只不过判断的是gender&lt;br&gt;最后需要处理的是sex字段的统一，用replace搞定&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;UPDATE user_sex
SET sex = replace(sex, &amp;apos;男&amp;apos;, 1);
UPDATE user_sex
SET sex = replace(sex, &amp;apos;女&amp;apos;, 2);
UPDATE user_sex
SET sex = replace(sex, &amp;apos;m&amp;apos;, 1);
UPDATE user_sex
SET sex = replace(sex, &amp;apos;f&amp;apos;, 2);
UPDATE user_sex
SET sex = replace(sex, &amp;apos;&amp;quot;&amp;apos;, 0);
# 最后一个是发现`gender:&amp;quot;&amp;quot;`情况
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;最后的最后，把临时表删了吧&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;DROP TABLE user_sex
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;到这里，可优化的部分还是有的，根据业务，还可以加一些判断减少待处理数据，比方说 uid为0：非注册用户 等等&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;总结一下，除了在添加user表sex列会锁表比较长时间，&lt;br&gt;最后的用临时表更新和其余查询操作的锁表时间几乎微乎其微，&lt;br&gt;把统一操作放临时表也可以避免查询操作等待的时间，&lt;br&gt;优化无非就是做了大化小的工作。&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;另外备注下 mysql的sql文件注释符”–”错了,需要一个空格,应该是”– “.&lt;br&gt;如果想发现更多，请使用mysql slow query log&lt;/p&gt;
&lt;p&gt;  #慢查询设置&lt;br&gt;    set GLOBAL long_query_time=1&lt;br&gt;    set GLOBAL log_slow_queries=ON&lt;br&gt;        set GLOBAL log_queries_not_using_indexes=1&lt;br&gt;    show variables like ‘%slow%’&lt;br&gt;    show variables like ‘%long_query%’&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# 以table查看
set global log_output=&amp;apos;TABLE&amp;apos;;
select * from mysql.slow_log;
&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      记一次mysql优化操作
    
    </summary>
    
      <category term="mysql" scheme="http://blog.newbmiao.com/categories/mysql/"/>
    
      <category term="optimize" scheme="http://blog.newbmiao.com/categories/mysql/optimize/"/>
    
    
      <category term="mysql" scheme="http://blog.newbmiao.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>向php大神致敬</title>
    <link href="http://blog.newbmiao.com/2015/09/24/a-tribute-to-the-great-god-of-php.html"/>
    <id>http://blog.newbmiao.com/2015/09/24/a-tribute-to-the-great-god-of-php.html</id>
    <published>2015-09-24T04:59:24.000Z</published>
    <updated>2016-07-07T13:09:18.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;strong&gt;向鸟哥（laruence）致敬，向所有php大神致敬&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;PHP7正式版就要发布了，鸟哥2015在Qcon中演讲&lt;a href=&quot;http://pan.baidu.com/s/1o6lCXRk&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PHP7 – The New Engine for old good train .pdf&lt;/a&gt; 已经透露了许多性能提升。&lt;/p&gt;
&lt;p&gt;今天才看了一些，虽然目前还不能get到很多点，但是内心还是很受鼓舞。附文一篇帮助了解。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://hansionxu.blog.163.com/blog/static/24169810920158704014772/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PHP 7 的革新与性能优化&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;关于鸟哥 ,再附一文与phper共勉&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://www.oschina.net/news/59059/laruence-interview&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PHP 鸟哥：我也曾经是“不适合”编程的人&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      向php大神致敬
    
    </summary>
    
      <category term="journal" scheme="http://blog.newbmiao.com/categories/journal/"/>
    
    
      <category term="journal" scheme="http://blog.newbmiao.com/tags/journal/"/>
    
  </entry>
  
  <entry>
    <title>mysql常用函数积累</title>
    <link href="http://blog.newbmiao.com/2015/09/23/mysql-common-function-accumulation.html"/>
    <id>http://blog.newbmiao.com/2015/09/23/mysql-common-function-accumulation.html</id>
    <published>2015-09-23T13:56:47.000Z</published>
    <updated>2017-02-08T02:31:33.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;时间处理&quot;&gt;&lt;a href=&quot;#时间处理&quot; class=&quot;headerlink&quot; title=&quot;时间处理&quot;&gt;&lt;/a&gt;时间处理&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;FROM_UNIXTIME&lt;/p&gt;
&lt;figure class=&quot;highlight cs&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;UNIX时间戳转换为日期用函数：&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;FROM_UNIXTIME&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;span class=&quot;number&quot;&gt;1156219870&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;UNIX_TIMESTAMP&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;日期转换为UNIX时间戳用函数：&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;UNIX_TIMESTAMP&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2006-11-04 12:23:00&#39;&lt;/span&gt;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;date_format&lt;/p&gt;
&lt;figure class=&quot;highlight cos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;查询当天的记录数：&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	DATE_FORMAT(FROM_UNIXTIME(ctime),&#39;&lt;span class=&quot;built_in&quot;&gt;%Y&lt;/span&gt;-&lt;span class=&quot;built_in&quot;&gt;%m&lt;/span&gt;-&lt;span class=&quot;built_in&quot;&gt;%d&lt;/span&gt;&#39;) = curdate()&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;N天内记录&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; *  &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; table_name &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;datediff&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;curdate&lt;/span&gt;(),from_unixtime(timestamp_colname,&lt;span class=&quot;string&quot;&gt;&#39;%Y-%m-%d&#39;&lt;/span&gt;))&amp;gt;=N;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;字符串处理&quot;&gt;&lt;a href=&quot;#字符串处理&quot; class=&quot;headerlink&quot; title=&quot;字符串处理&quot;&gt;&lt;/a&gt;字符串处理&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;IF&lt;/p&gt;
&lt;figure class=&quot;highlight gauss&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;IF&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;expr&lt;/span&gt;,val1,val2) &lt;span class=&quot;meta&quot;&gt;#判断expr，为真则val1，否则val2&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;IFNULL&lt;/p&gt;
&lt;figure class=&quot;highlight autoit&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; IFNULL(expr1,expr2) &lt;span class=&quot;meta&quot;&gt;#非expr1则expr2&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ISNULL&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;ISNULL&lt;/span&gt;(&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MID&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;截取字符串&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;MID&lt;/span&gt;(expr1,&lt;span class=&quot;keyword&quot;&gt;start&lt;/span&gt;,&lt;span class=&quot;keyword&quot;&gt;length&lt;/span&gt;) #&lt;span class=&quot;keyword&quot;&gt;start&lt;/span&gt;从&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;开始&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;LOCATE&lt;/p&gt;
&lt;figure class=&quot;highlight perl&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;判断字符位置&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; LOCATE(&lt;span class=&quot;string&quot;&gt;&#39;ab&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;efgabc&#39;&lt;/span&gt;[,&lt;span class=&quot;keyword&quot;&gt;pos&lt;/span&gt;]) &lt;span class=&quot;comment&quot;&gt;#返回字符位置，从1开始，未找到返回0；pos参数可提供需要越过的查找offset&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;INSTR&lt;/p&gt;
&lt;figure class=&quot;highlight hsp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;判断字符位置,参数与LOCATE相反，无&lt;span class=&quot;keyword&quot;&gt;pos&lt;/span&gt;参数&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	select &lt;span class=&quot;keyword&quot;&gt;INSTR&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;efgabc&#39;&lt;/span&gt;，&lt;span class=&quot;string&quot;&gt;&#39;ab&#39;&lt;/span&gt;)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;concat &amp;amp; concat_ws&lt;/p&gt;
&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(str1,str2,[str3]...)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;concat_ws&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(separator,str1,str2,[str3])&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;group_concat&lt;/p&gt;
&lt;figure class=&quot;highlight applescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;列转行，默认,号分隔&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	group_concat(&lt;span class=&quot;built_in&quot;&gt;name&lt;/span&gt; separator &#39;;&#39;)  &lt;span class=&quot;comment&quot;&gt;#指定分隔符&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	group_concat(&lt;span class=&quot;built_in&quot;&gt;name&lt;/span&gt; order &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;name&lt;/span&gt; desc) &lt;span class=&quot;comment&quot;&gt;#指定排序&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#这里有个坑，默认返回是有长度限制的，一般是1024&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	show variables like &lt;span class=&quot;string&quot;&gt;&quot;group_concat_max_len&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#按需调整，当前生效&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;set&lt;/span&gt; GLOBAL group_concat_max_len=&lt;span class=&quot;number&quot;&gt;2048&lt;/span&gt;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ELT&lt;/p&gt;
&lt;figure class=&quot;highlight cs&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;根据N的值选择第N个字符串&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	ELT(N,str1,str2,str3,...)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	eg: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;elt&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;男&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;女&#39;&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;; &lt;span class=&quot;meta&quot;&gt;#枚举性别&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;FIND_IN_SET&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;FIND_IN_SET(str,strlist)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;eg1:in和FILD_IN_SET() 的区别&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;list&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; FIND_IN_SET( &lt;span class=&quot;string&quot;&gt;&#39;daodao&#39;&lt;/span&gt; , &lt;span class=&quot;keyword&quot;&gt;list&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;所以如果&lt;span class=&quot;keyword&quot;&gt;list&lt;/span&gt;是常量（如：(&lt;span class=&quot;string&quot;&gt;&#39;libk&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;zyfon&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;daodao&#39;&lt;/span&gt;))，则可以直接用&lt;span class=&quot;keyword&quot;&gt;IN&lt;/span&gt;， 否则要用FIND_IN_SET()函数&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;eg2:按&lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;排序&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; article &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; FIND_IN_SET(&lt;span class=&quot;string&quot;&gt;&#39;id&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1,5,3&#39;&lt;/span&gt;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;QUOTE&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;安全转义&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;trim&lt;/p&gt;
&lt;figure class=&quot;highlight ruleslanguage&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; &lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TRIM&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;  bar   &#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        -&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;bar&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; &lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TRIM&lt;/span&gt;(LEADING &lt;span class=&quot;string&quot;&gt;&#39;x&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;xxxbarxxx&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        -&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;barxxx&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; &lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TRIM&lt;/span&gt;(BOTH &lt;span class=&quot;string&quot;&gt;&#39;x&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;xxxbarxxx&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        -&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;bar&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; &lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TRIM&lt;/span&gt;(TRAILING &lt;span class=&quot;string&quot;&gt;&#39;xyz&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;barxxyz&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        -&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;barx&#39;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;未完待续。。。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      mysql常用函数积累
    
    </summary>
    
      <category term="mysql" scheme="http://blog.newbmiao.com/categories/mysql/"/>
    
    
      <category term="mysql" scheme="http://blog.newbmiao.com/tags/mysql/"/>
    
  </entry>
  
</feed>
